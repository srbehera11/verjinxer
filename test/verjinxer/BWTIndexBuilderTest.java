package verjinxer;

import static org.junit.Assert.*;

import java.io.IOException;
import java.nio.ByteBuffer;
import java.util.Arrays;
import java.util.Comparator;
import java.util.Random;

import org.junit.Test;

import verjinxer.sequenceanalysis.Alphabet;
import verjinxer.sequenceanalysis.BWTIndex;
import verjinxer.sequenceanalysis.Sequences;
import verjinxer.sequenceanalysis.SuffixXorDLL;

public class BWTIndexBuilderTest {
   
   final static Alphabet alphabet = new Alphabet(new String[] { "##symbols:1", "1", "2", "3", "4", "5", "6", "7", "8", "##wildcards", "9",
         "##endofline:0" });
   
   @Test
   public void testBuildDet() {
      byte[][] s = {
            {1,1,3,1,2,1,1,3,1,2,4,0},
            {1,1,3,1,2,1,1,3,1,2,0},
            {4,4,2,2,4,1,2,4,4,2,1,3,3,3,2,2,1,4,1,1,1,3,2,2,4,0},
            {4,4,2,2,4,1,2,4,4,2,1,3,3,3,2,2,1,4,1,1,1,3,2,2,4,0},
            {4,3,2,1,4,3,2,1,4,3,2,4,1,3,2,4,1,3,2,4,4,4,2,3,1,3,2,4,1,4,0},
            {3,2,4,3,2,4,4,1,3,4,2,1,4,2,3,4,2,3,4,4,2,1,3,4,1,4,4,3,2,1,2,3,1,3,2,1,2,3,1,3,2,1,2,1,0},
            {4,3,1,4,3,2,4,1,2,1,3,2,1,2,3,1,4,2,3,4,1,2,3,4,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,0},
            {3,1,4,3,1,3,2,4,1,3,2,1,3,2,4,1,3,2,1,2,3,4,1,3,2,1,3,2,4,0},
            {4,3,4,3,2,1,3,2,4,1,3,2,4,1,3,2,4,1,2,3,4,1,3,2,4,1,3,2,4,1,2,3,4,0},
            {4,3,2,1,4,3,2,1,2,3,2,3,4,3,2,1,3,2,4,2,3,1,0},
            {1,2,4,1,4,2,3,1,4,2,1,4,3,2,1,4,3,2,0},
            {3,4,0},
            {6, 7, 5, 3, 4, 4, 8, 5, 8, 1, 3, 3, 4, 1, 5, 5, 6, 2, 0}
      };
      
      for (int si = 0; si < s.length; si++) {
         buildBWTandTest(s[si], si, alphabet);
      }
   }
 
   @Test
   public void testBuildDetWithWildcards() {
      byte[][] s = {
            {9,1,9,2,9,0},
            {9,9,2,2,9,1,2,9,9,2,1,3,3,3,2,2,1,9,1,1,1,3,2,2,9,0},
            {4,2,1,2,2,2,9,9,1,2,9,9,1,2,9,9,4,1,4,9,9,4,1,1,2,0},
            {4,2,1,2,2,2,9,9,1,2,9,9,9,9,9,9,9,9,9,9,1,2,9,9,4,1,4,9,9,4,1,1,2,0},
            {4,2,1,2,2,2,9,9,1,2,9,9,9,8,8,8,9,9,9,9,1,2,9,9,4,1,4,9,9,4,1,1,2,0},
      };
      
      for (int si = 0; si < s.length; si++) {
         buildBWTandTest(s[si], si, alphabet);
      }
   }
   
   @Test
   public void testBuildRand() {
      byte[] s = null;

      Random rand = new Random(100);

      for (int si = 0; si < 50; si++) {
         s = new byte[500 + rand.nextInt(500)];

         for (int j = 0; j < s.length - 1; j++) {
            s[j] = (byte) (1 + rand.nextInt(8));
         }
         s[s.length - 1] = 0;
         buildBWTandTest(s,si, alphabet);
      }
   }

   @Test
   public void testBuildchrM() {
      byte[] s = {3,1,4,2,1,2,1,3,3,4,2,4,1,4,2,1,2,2,2,4,1,4,4,1,1,2,2,1,2,4,2,1,2,3,3,3,1,3,2,4,2,4,2,2,1,4,3,2,1,4,4,4,3,3,4,1,4,4,4,4,2,3,4,2,4,3,3,3,3,3,3,4,3,4,3,2,1,2,3,2,3,1,4,1,3,2,1,4,4,3,2,3,1,3,1,2,3,2,4,3,3,1,3,2,2,3,3,1,3,2,1,2,2,2,4,1,4,3,4,2,3,2,1,3,4,1,4,2,4,3,4,2,4,4,4,3,1,4,4,2,2,4,3,2,2,4,2,1,4,4,2,4,1,4,4,1,4,4,4,1,4,2,3,2,1,2,2,4,1,2,3,4,4,2,1,1,4,1,4,4,1,2,1,3,3,2,3,1,1,2,1,4,1,2,2,4,1,2,4,1,1,1,3,4,3,4,3,4,4,1,1,4,4,1,1,4,4,1,1,4,3,2,4,4,3,4,1,3,3,1,2,1,4,1,1,4,1,1,4,1,1,2,1,1,4,4,3,1,1,4,3,4,2,4,3,2,1,2,1,3,2,2,3,2,4,4,4,2,2,1,2,1,2,1,3,1,2,1,4,2,1,4,1,1,2,1,1,1,1,1,1,4,4,4,2,2,1,2,2,1,1,1,2,2,2,2,2,2,2,2,4,2,2,2,2,2,2,3,2,4,4,2,4,3,3,2,2,1,2,1,3,2,1,2,4,4,1,1,1,2,1,2,1,4,2,4,2,4,3,2,2,1,1,1,2,2,2,2,1,1,1,1,1,2,1,1,1,3,1,1,2,2,2,4,1,1,2,1,2,2,1,3,2,2,4,1,1,2,2,1,3,1,4,4,4,2,1,1,1,4,4,4,4,1,4,2,4,4,4,1,3,3,2,3,3,4,1,4,3,2,1,2,4,4,4,4,1,1,2,1,3,4,2,1,2,2,2,2,2,2,1,1,2,4,1,1,2,1,2,1,4,4,1,4,4,4,4,2,2,2,2,4,2,2,2,1,2,4,2,2,2,1,4,1,2,4,1,2,4,1,1,4,2,4,2,1,4,2,1,1,4,1,2,1,1,2,2,2,2,2,3,2,2,2,1,4,2,2,4,1,2,2,2,1,3,2,1,2,1,2,1,2,1,2,1,2,2,3,2,4,3,2,4,1,1,2,2,2,2,1,4,1,2,2,2,2,3,1,1,2,2,1,1,2,2,1,1,1,2,2,2,2,1,1,1,3,1,2,1,2,2,2,2,2,2,1,2,1,3,4,4,4,1,4,3,4,1,3,2,4,4,1,2,2,4,2,2,4,2,1,1,1,3,2,1,1,4,1,2,1,2,4,3,1,1,1,1,4,3,4,4,4,1,3,1,2,3,3,3,2,4,2,1,2,1,4,2,1,2,2,2,2,1,4,1,1,1,2,1,1,1,4,1,3,3,4,4,4,3,3,4,2,2,4,1,3,2,2,4,4,4,2,4,1,4,4,1,3,2,4,2,4,4,1,3,4,1,1,3,1,4,4,1,2,1,2,1,4,3,2,1,1,3,2,1,4,2,2,2,2,3,4,4,2,2,1,3,4,3,1,3,4,4,2,1,2,2,2,4,2,4,1,1,1,4,2,1,2,2,1,2,3,1,4,2,1,1,1,1,3,3,3,1,2,1,1,3,2,1,4,2,1,1,3,2,1,2,3,2,1,3,2,1,1,4,3,2,1,3,2,4,2,1,1,1,1,2,3,2,4,4,1,3,2,2,4,1,3,2,2,1,2,1,2,2,2,2,2,1,2,3,3,3,1,1,1,2,1,3,2,1,3,4,3,1,4,4,1,1,2,2,4,4,4,1,3,2,1,1,4,1,1,1,2,3,1,1,1,3,4,4,4,1,1,2,4,1,1,3,2,4,1,4,1,2,4,1,1,2,2,2,2,1,3,3,3,4,4,3,3,4,2,1,1,4,4,4,2,3,4,3,2,2,1,3,2,2,1,2,2,3,2,3,3,4,2,1,2,1,2,3,1,4,4,1,1,2,2,2,1,1,3,4,2,1,1,4,1,3,1,1,3,2,2,3,3,2,3,4,1,1,1,3,1,3,4,3,4,4,4,4,1,3,1,4,2,1,2,2,2,2,2,4,2,2,2,2,1,1,4,1,1,1,3,2,4,1,1,1,1,2,4,2,1,2,2,4,3,1,3,4,4,3,4,1,1,1,1,1,1,2,4,2,2,1,3,4,4,3,1,2,1,2,1,1,1,1,4,1,3,1,2,4,1,2,3,1,1,1,3,4,3,3,2,4,4,4,1,1,2,1,4,1,4,2,4,3,1,1,2,1,2,1,2,1,1,4,1,3,2,4,1,1,3,1,2,2,2,1,1,1,2,4,3,3,3,1,4,4,1,3,1,4,1,2,2,2,2,1,2,4,1,4,3,2,4,4,1,3,2,2,2,4,1,1,1,2,2,4,2,1,1,2,1,3,4,4,1,1,1,4,2,1,1,2,1,1,1,1,2,4,3,2,4,2,3,2,2,1,3,1,1,2,1,2,4,1,2,3,1,3,2,2,1,2,1,3,2,4,4,1,1,1,1,2,4,2,1,1,1,3,3,1,2,2,4,3,3,2,3,3,4,3,2,4,4,2,1,4,1,4,2,2,2,4,2,4,1,3,1,3,3,1,3,2,2,4,3,4,4,2,4,3,4,1,1,4,2,3,1,4,1,1,1,2,2,2,2,3,1,4,2,1,1,2,2,4,2,1,2,2,1,2,2,4,2,4,4,3,2,4,2,1,3,2,2,4,1,4,1,4,1,2,2,3,2,2,1,4,2,4,4,2,1,3,2,1,1,1,2,2,2,4,3,1,4,3,1,1,3,3,2,4,1,2,1,1,1,3,4,1,1,3,2,3,2,1,1,3,4,1,2,2,2,1,2,3,4,1,1,1,3,1,2,3,4,4,1,3,3,4,2,1,1,3,3,4,3,4,1,3,2,2,2,1,4,3,1,3,3,4,3,3,2,1,1,3,1,1,1,4,3,3,3,2,4,1,2,1,4,4,4,4,2,4,1,2,2,2,2,1,3,1,1,1,1,2,4,1,2,3,1,4,1,3,2,2,2,4,4,1,4,3,1,1,1,2,4,4,1,1,3,3,3,4,2,3,1,1,3,3,4,3,3,1,4,4,4,1,3,2,1,3,4,1,1,1,2,4,3,1,3,1,3,4,1,3,1,3,4,3,2,4,4,1,3,4,4,3,1,1,2,1,3,3,3,2,2,2,4,3,1,1,3,2,3,2,3,4,1,2,1,2,1,2,2,3,2,2,2,3,4,2,1,2,2,2,4,2,2,4,2,1,1,3,4,1,4,1,2,4,4,2,1,1,1,3,3,1,2,1,4,4,4,1,1,2,4,1,1,1,1,2,2,2,2,4,1,2,3,2,1,4,4,4,1,4,1,4,1,3,1,3,3,1,3,1,2,1,1,3,4,2,3,4,1,1,2,1,4,3,3,4,1,1,3,4,3,4,1,2,4,3,3,1,1,1,3,4,3,2,1,2,4,4,3,3,1,2,3,1,1,2,2,1,3,1,3,4,3,4,1,3,2,4,4,1,1,2,1,2,1,1,1,3,2,1,2,2,2,1,1,2,4,4,1,2,1,2,4,4,1,3,3,1,3,1,4,4,4,2,1,1,2,4,4,1,1,2,4,4,3,1,2,2,3,2,4,2,4,3,1,3,2,4,1,1,1,2,2,4,1,3,2,2,2,2,1,1,1,2,2,2,1,2,4,2,2,1,2,2,4,4,1,2,4,1,2,2,1,3,1,2,1,1,2,2,4,4,1,3,2,2,1,1,1,2,2,1,4,4,4,1,2,2,2,1,1,1,4,1,1,1,3,4,1,4,1,3,3,2,3,1,4,1,3,1,1,1,4,4,3,1,1,1,2,2,4,3,3,2,3,2,1,1,4,1,3,1,4,1,4,1,3,4,1,2,2,3,2,1,1,3,3,3,1,1,1,3,1,4,3,1,1,1,1,1,4,4,1,4,1,1,2,2,1,1,3,2,1,4,1,1,4,1,4,1,3,2,1,1,3,3,1,2,4,1,1,2,2,2,2,4,1,4,1,2,2,4,4,2,4,3,2,1,4,1,1,4,3,1,1,4,4,1,1,2,4,1,3,1,1,1,4,1,1,2,4,4,4,3,2,1,1,3,3,1,3,1,3,2,2,1,1,1,3,2,4,1,1,3,1,2,2,2,2,2,3,1,1,1,2,2,1,3,1,2,3,1,3,2,4,1,2,2,4,1,1,3,1,1,2,1,3,2,4,1,1,1,1,3,1,3,2,1,2,1,2,2,2,3,4,2,4,1,4,3,4,1,3,2,1,1,1,1,4,1,3,4,3,3,3,1,1,3,1,4,4,4,1,4,1,3,3,4,1,3,1,3,3,2,3,1,2,1,1,1,2,2,4,1,2,2,3,1,3,2,2,4,3,3,4,3,1,4,1,3,2,4,3,3,4,4,3,4,2,2,1,1,3,1,4,1,3,1,1,4,2,4,4,1,3,4,4,2,1,1,2,4,4,4,1,1,1,4,4,4,3,2,2,2,1,2,1,3,1,1,2,2,2,4,2,4,1,1,1,4,2,2,2,2,4,4,3,4,1,1,1,4,4,4,1,1,2,4,3,4,4,1,3,4,2,2,1,1,1,3,1,3,3,1,1,2,1,3,2,4,2,4,4,4,3,3,1,2,1,2,4,1,3,3,1,1,1,1,1,1,2,2,4,4,3,4,1,3,1,3,1,3,1,3,4,1,1,1,1,1,1,4,4,4,1,1,2,1,2,2,2,1,4,1,3,4,1,3,3,2,2,4,1,1,1,1,3,2,1,3,2,2,1,2,2,1,1,4,4,1,1,3,1,1,1,3,2,3,4,4,2,1,1,3,2,4,2,1,1,2,1,2,2,2,1,2,4,1,2,2,4,1,1,1,1,1,1,4,2,2,2,1,1,1,2,1,4,1,4,1,1,2,4,3,1,1,2,4,2,2,4,2,1,2,1,2,2,2,1,1,4,4,3,3,1,2,2,1,1,4,2,4,1,4,2,1,2,2,2,4,1,4,1,3,1,1,3,1,1,2,4,1,1,4,3,4,4,1,3,4,1,4,1,1,3,4,1,1,2,1,4,3,1,1,1,1,2,1,4,4,2,4,2,2,4,2,2,3,2,1,4,1,1,3,2,2,4,3,2,3,4,2,1,3,1,4,2,1,1,1,1,2,1,2,4,3,1,1,2,4,3,1,2,1,1,4,4,1,1,2,1,3,2,2,2,1,1,4,1,4,2,4,1,2,1,1,4,2,1,1,2,2,1,1,2,1,1,3,4,2,1,4,4,1,4,4,1,2,2,2,4,2,1,2,4,3,4,2,1,1,2,2,2,1,1,2,1,2,1,3,3,2,1,4,3,2,4,2,1,4,1,1,3,3,1,1,1,3,3,4,4,1,1,1,1,1,1,1,3,4,1,1,1,1,3,3,1,1,2,4,2,3,3,2,1,1,1,2,2,4,4,1,2,2,2,2,3,2,2,4,3,4,4,4,1,2,2,1,1,1,1,1,2,1,4,2,1,2,2,4,2,4,1,3,2,1,4,2,1,2,2,1,3,4,1,4,4,1,3,1,3,3,2,1,2,2,3,2,2,4,3,2,2,2,1,3,4,3,1,2,1,2,1,4,3,4,4,4,1,1,2,3,3,2,2,3,2,3,3,4,1,2,2,2,4,1,1,2,2,3,4,3,2,1,1,1,3,3,4,1,3,2,1,4,1,1,4,2,1,2,4,4,3,4,4,2,2,4,4,1,1,1,4,1,3,3,3,1,2,2,4,3,4,1,4,3,1,1,4,3,3,2,4,2,2,1,2,3,1,3,3,3,4,4,2,1,3,2,4,3,4,2,4,2,4,4,1,2,4,4,4,4,1,1,2,2,1,3,4,3,1,1,1,4,4,3,1,2,2,4,3,2,2,2,3,4,3,1,1,3,1,3,3,2,3,3,3,2,1,4,3,1,2,1,2,1,3,2,1,1,3,1,2,3,1,3,1,1,3,1,2,2,2,4,1,4,3,3,1,3,2,4,4,4,1,1,4,4,4,1,4,4,1,1,4,3,2,1,1,1,2,1,3,4,1,2,2,4,1,1,2,1,1,1,2,2,2,1,2,1,3,3,4,2,2,4,1,1,1,2,4,1,2,2,1,1,1,2,2,4,3,2,1,4,4,1,1,1,1,1,4,4,4,2,3,3,4,4,3,3,3,3,2,3,1,2,2,4,2,3,3,1,3,2,1,3,1,1,2,2,2,1,1,2,2,4,2,2,3,1,3,2,1,3,4,1,2,1,4,3,2,4,1,1,3,1,2,4,4,2,1,2,2,1,3,4,2,1,1,1,3,2,3,1,1,2,4,1,2,4,1,4,1,2,4,2,1,1,4,4,3,1,4,2,2,1,1,4,1,1,2,4,4,3,1,2,2,1,1,2,3,3,1,1,2,1,1,3,4,4,1,2,2,2,4,1,3,3,3,1,4,1,1,2,1,3,2,3,2,1,1,4,2,2,4,1,4,4,2,4,1,3,1,3,4,2,2,1,4,1,4,2,1,1,2,1,1,4,1,3,3,3,4,4,4,1,2,3,1,2,2,4,2,3,1,4,3,4,4,3,3,1,4,2,1,3,3,1,2,1,4,2,2,2,3,1,4,3,3,4,3,2,1,3,2,2,3,2,4,1,4,4,1,1,1,3,3,4,4,2,3,4,4,4,3,4,4,2,1,1,2,3,1,4,4,1,1,1,3,4,2,2,4,1,2,3,4,3,1,4,2,4,3,1,3,4,4,2,1,3,1,2,2,3,3,1,3,4,1,1,4,2,2,1,3,3,4,2,3,3,4,4,4,2,4,1,4,2,4,1,2,4,4,2,1,1,1,4,4,2,2,4,2,2,2,4,3,4,1,2,3,1,1,1,3,3,1,2,1,1,3,1,3,1,1,1,4,1,1,3,3,2,2,4,1,2,4,4,2,1,2,1,1,1,3,2,3,2,2,4,4,2,2,2,2,2,3,4,1,1,1,4,3,1,4,1,4,2,1,4,2,4,2,1,1,2,4,4,1,3,4,1,4,4,1,4,1,2,2,2,1,2,1,2,2,2,1,2,2,2,1,1,3,1,1,2,1,3,3,3,4,4,4,3,4,4,1,1,3,1,4,3,3,2,1,3,1,3,2,2,2,3,3,4,1,1,4,2,3,2,1,4,1,1,1,1,2,4,4,1,1,1,1,2,4,4,4,1,2,1,3,4,2,1,3,1,3,3,4,4,2,1,1,4,4,2,2,4,2,4,4,2,4,4,1,1,2,1,1,2,1,4,1,2,2,2,1,4,3,3,2,2,1,1,2,2,4,2,2,4,1,2,4,2,2,4,2,1,4,4,3,4,1,2,2,2,1,4,4,2,4,1,1,4,2,3,2,1,1,4,3,3,2,1,4,4,2,2,4,1,1,4,3,2,4,4,1,2,2,3,1,1,2,3,1,1,1,1,1,4,4,2,4,1,3,3,2,4,1,4,1,4,1,2,1,1,2,4,1,2,3,2,1,1,1,3,3,2,2,2,2,1,1,2,3,4,4,3,4,1,3,3,2,2,2,2,4,1,2,3,3,3,2,4,1,2,4,1,2,1,1,2,2,2,4,4,2,3,2,4,3,1,2,3,2,2,1,4,1,1,1,1,2,4,2,4,4,2,1,2,2,1,1,1,3,1,3,2,2,2,2,4,1,1,1,1,2,2,2,3,2,2,1,2,1,4,2,4,1,2,2,1,4,2,1,2,2,2,4,2,4,1,2,1,4,2,1,2,2,3,2,2,2,2,3,1,2,2,4,4,1,3,2,4,2,4,2,1,2,2,1,4,2,3,2,4,2,4,4,2,4,1,2,4,1,4,3,1,1,2,2,2,2,2,2,4,2,2,2,2,1,4,1,2,2,2,1,1,2,2,2,2,2,4,3,3,4,2,1,1,2,2,4,2,1,1,2,2,4,1,3,3,2,2,4,2,2,4,1,4,4,4,1,4,4,2,4,1,3,2,2,1,2,2,4,2,4,1,3,2,2,4,1,3,2,2,3,4,4,4,1,2,4,2,1,1,4,2,2,4,2,4,3,1,4,2,1,3,3,3,4,3,1,3,2,1,4,2,1,1,1,2,4,2,1,1,1,2,4,1,2,3,2,2,2,4,3,1,4,2,3,3,2,3,2,1,2,4,3,2,3,1,3,2,1,3,4,1,3,2,2,2,1,1,1,2,1,1,4,2,4,2,1,4,1,4,3,1,1,3,4,2,1,2,2,2,4,1,3,2,2,1,4,2,1,4,4,2,4,1,2,4,1,4,2,1,1,2,1,4,4,1,2,4,1,1,4,1,1,3,4,3,3,2,4,2,2,4,4,4,1,1,2,2,4,2,4,2,2,1,2,2,2,4,4,1,4,2,1,2,1,1,2,1,2,1,1,3,1,1,2,1,2,2,4,2,4,3,1,4,4,1,2,4,2,2,4,3,2,2,1,4,2,1,4,3,1,2,2,2,4,4,3,3,2,2,1,4,1,1,4,1,4,3,1,4,4,4,1,4,2,4,2,2,1,2,1,2,4,1,3,2,1,3,1,3,1,2,2,1,1,2,2,3,1,1,2,2,2,2,2,4,4,2,3,1,2,2,4,4,3,2,2,3,1,1,3,3,3,3,1,3,4,2,2,3,1,1,2,4,1,3,4,2,4,2,1,3,3,2,4,4,2,1,1,2,1,4,2,3,1,1,4,1,2,3,2,2,3,2,1,3,3,2,2,2,2,4,4,2,3,2,2,2,4,1,4,4,2,4,4,2,1,4,1,3,2,2,3,1,1,4,1,2,1,2,1,1,1,2,1,4,4,1,4,4,1,4,1,1,4,1,1,1,2,1,2,2,2,4,2,1,2,2,1,2,4,1,2,1,1,4,2,4,4,2,2,4,1,3,3,1,1,2,1,1,2,1,4,1,4,3,1,2,3,2,1,2,4,2,4,2,2,2,2,4,3,1,1,2,4,2,4,1,2,1,2,1,1,2,1,4,1,4,4,4,4,3,4,2,1,2,2,1,1,3,1,2,2,2,4,1,2,4,4,2,4,1,1,2,2,4,2,2,2,4,3,4,4,2,4,4,1,4,3,1,1,4,4,2,3,1,1,2,1,3,2,1,4,1,2,2,2,2,2,3,1,4,4,2,2,3,2,4,1,2,3,1,2,2,1,1,2,4,2,1,4,1,2,1,2,2,4,2,2,4,1,4,3,1,1,1,1,1,1,2,4,4,2,2,4,1,2,2,1,2,4,2,1,2,2,2,4,1,3,2,1,4,4,1,2,4,4,1,4,1,4,3,1,4,1,4,3,4,2,4,2,2,1,4,1,2,2,2,1,4,4,1,2,1,1,4,2,4,2,2,1,3,2,1,4,4,2,2,2,2,2,4,2,1,1,1,2,2,4,1,1,3,1,1,1,4,1,4,3,4,2,4,3,1,4,1,1,1,1,3,1,3,4,4,1,2,4,4,4,3,1,4,1,3,1,3,4,1,1,1,4,1,1,4,1,3,3,1,3,2,4,4,1,1,1,2,2,2,2,2,4,4,1,4,4,4,2,4,1,3,3,1,2,4,1,4,3,1,3,1,1,4,2,3,1,1,2,2,2,1,4,2,2,2,4,3,1,3,1,1,4,2,2,1,1,1,1,4,4,2,4,2,2,3,4,3,2,2,1,2,2,4,1,4,2,1,2,1,2,2,2,2,1,4,2,2,4,1,1,1,3,4,1,1,3,3,4,2,1,3,2,4,1,1,1,4,1,1,3,2,4,1,4,2,3,3,3,2,2,2,1,4,1,2,2,2,2,3,1,1,1,1,4,3,4,4,3,3,4,4,1,4,1,2,2,2,4,4,2,2,2,3,4,1,2,4,1,1,4,4,1,1,4,2,2,2,2,4,3,3,2,2,2,1,1,2,2,2,3,4,2,1,4,2,4,1,2,4,2,4,1,2,2,1,4,2,4,4,4,3,2,1,3,3,2,1,2,1,2,4,2,1,4,2,1,2,1,3,2,3,2,4,1,1,3,2,4,2,3,2,1,2,4,3,1,4,4,4,4,4,4,1,2,2,4,3,1,3,4,1,3,3,2,2,4,1,3,1,1,1,4,1,1,1,2,1,4,3,2,4,1,3,2,4,4,4,4,1,4,4,2,2,1,3,4,4,2,4,1,1,2,2,1,1,1,1,1,1,1,4,1,1,1,2,2,2,4,2,3,4,4,2,2,1,2,1,3,1,1,3,2,4,3,2,2,1,4,2,1,1,3,4,1,4,4,4,2,2,4,2,1,2,3,2,1,1,3,2,1,1,2,2,3,2,1,4,2,2,1,4,1,1,4,2,2,4,4,2,4,1,1,4,1,3,2,4,1,4,2,2,4,2,4,4,2,1,1,2,1,1,4,1,4,1,2,4,2,4,2,2,3,3,1,2,1,1,4,3,1,1,2,2,1,4,1,1,2,2,1,1,4,1,2,4,1,2,2,1,1,4,2,1,1,4,1,2,4,2,1,4,2,1,4,4,1,1,4,1,1,4,2,1,4,1,1,4,3,3,2,4,1,4,1,3,2,1,1,4,1,1,1,1,2,4,1,3,3,1,1,4,1,3,2,2,2,2,2,4,4,4,2,1,2,4,4,2,4,3,1,3,4,2,2,2,1,3,1,3,3,4,4,1,2,2,2,1,1,3,3,2,1,2,2,2,2,4,2,4,3,1,2,1,4,2,2,3,3,2,2,4,3,2,4,4,2,4,4,2,4,2,1,2,1,4,3,1,2,1,1,1,1,1,2,4,1,3,2,2,2,2,2,1,4,2,4,2,1,1,4,2,1,4,1,4,1,2,2,1,1,1,4,2,4,2,4,2,2,2,4,2,1,2,4,1,1,1,2,3,4,1,1,3,2,2,4,4,2,4,2,2,4,2,1,2,4,2,4,2,4,2,1,1,4,2,4,4,1,4,2,2,1,4,2,1,4,1,3,2,1,3,3,2,1,3,4,4,3,1,3,3,4,3,3,1,4,4,1,1,1,2,2,1,1,1,2,2,2,1,3,2,4,1,2,3,2,1,1,1,1,4,2,4,4,1,3,2,1,4,1,2,4,2,2,4,2,1,1,4,4,1,2,2,2,1,2,1,4,1,3,3,1,4,3,1,1,4,1,1,4,1,3,2,1,3,4,4,2,4,1,2,2,3,4,1,2,1,1,2,2,2,4,1,1,2,1,4,1,1,2,2,1,4,4,2,4,4,1,1,4,4,4,1,1,2,4,1,4,4,4,1,4,1,4,4,1,4,2,2,4,1,1,2,4,1,2,4,1,2,2,3,2,1,4,4,2,2,4,1,2,4,1,2,4,2,1,1,2,4,4,1,1,1,2,4,2,2,1,3,2,1,2,2,1,2,3,1,2,2,2,4,1,2,4,1,2,4,1,4,2,4,2,3,2,1,2,2,4,3,1,1,1,2,1,1,3,2,4,1,1,2,1,4,3,1,2,4,1,1,2,1,2,2,2,4,4,1,1,4,4,2,2,1,4,2,2,1,2,2,2,4,2,2,4,2,4,2,2,2,4,1,3,3,1,3,3,2,2,4,3,2,2,2,2,2,3,2,4,1,1,2,2,3,3,2,4,4,4,4,4,3,2,2,2,1,1,1,4,3,3,3,2,2,1,4,4,1,4,2,3,1,1,3,1,1,4,4,2,1,2,1,1,1,1,1,1,2,1,1,4,1,3,2,2,4,2,1,4,2,1,4,2,2,2,2,1,2,2,1,4,2,1,4,1,3,2,2,1,2,2,1,4,2,1,2,2,2,4,2,2,4,4,1,1,2,2,4,2,4,1,2,4,4,2,4,1,2,2,4,1,2,3,2,2,4,1,1,4,2,4,1,2,4,2,2,1,2,2,4,2,1,1,4,2,1,2,1,2,4,1,2,4,2,2,2,2,1,4,1,4,2,4,1,1,2,1,1,2,3,4,1,1,1,1,1,4,1,1,1,1,4,3,1,2,1,3,4,4,4,3,1,1,2,1,4,1,2,1,1,1,1,2,2,2,1,2,2,2,2,1,4,4,2,2,4,2,2,2,2,1,2,1,2,4,2,1,4,2,3,2,2,2,4,4,1,2,2,1,2,3,2,4,1,2,4,2,2,4,1,2,2,4,1,4,2,4,2,2,2,2,4,4,4,4,1,4,1,2,4,1,1,4,1,1,4,2,4,4,1,4,1,3,1,1,1,4,4,4,1,3,3,4,4,1,1,1,4,1,2,1,3,1,2,2,1,1,3,1,3,2,2,4,4,2,1,1,1,3,2,2,2,4,2,1,3,4,1,1,3,4,4,3,2,1,1,4,1,2,4,4,1,1,4,4,4,2,4,3,2,1,1,2,1,3,2,4,1,1,3,3,1,2,4,3,2,1,1,1,1,2,2,2,2,1,2,4,2,4,3,2,1,4,2,1,1,2,4,3,1,1,2,3,2,1,1,1,4,2,1,3,2,2,1,2,4,4,4,1,1,4,4,1,1,3,2,4,1,1,3,2,2,2,4,4,1,2,4,1,3,1,2,2,1,1,4,3,3,3,1,2,4,4,1,1,1,2,2,2,1,2,1,1,1,2,1,2,4,4,1,3,4,4,1,1,2,1,3,2,4,1,1,3,2,1,2,2,2,4,1,1,4,2,1,1,2,4,3,3,2,4,4,2,1,1,4,2,4,1,2,4,4,2,4,2,2,2,3,2,2,3,2,2,3,3,3,1,1,1,1,1,1,3,3,2,3,3,3,1,3,1,1,3,2,2,2,2,3,3,2,1,3,3,4,4,4,3,1,1,3,2,4,3,2,4,4,2,4,4,2,3,1,1,4,4,4,3,2,1,1,4,4,2,1,1,4,1,4,3,1,1,1,1,4,2,1,2,2,4,2,3,3,1,3,2,4,3,3,4,1,1,1,1,1,3,1,3,3,2,2,4,1,1,2,2,2,2,4,3,4,2,4,4,4,1,3,1,4,4,4,1,2,1,3,4,2,2,1,1,4,3,2,4,4,2,1,2,4,2,1,3,2,2,1,4,4,4,4,1,2,2,4,2,1,2,2,2,2,2,1,2,4,3,1,4,3,4,4,2,3,2,2,3,1,2,2,3,4,4,3,1,2,4,1,4,4,2,4,2,4,1,2,1,1,1,2,2,1,2,1,1,1,3,1,2,1,4,4,3,3,1,1,2,1,2,4,1,4,1,2,2,4,1,4,4,1,4,4,2,3,3,2,3,2,1,4,3,1,3,2,4,3,3,1,3,4,2,2,4,1,3,3,2,1,2,1,3,2,4,2,4,1,1,3,2,2,4,2,2,4,4,1,4,4,2,3,1,3,2,2,3,1,3,2,4,3,3,3,2,2,1,3,2,2,1,3,3,2,1,1,2,2,4,4,2,4,1,3,3,4,1,1,2,3,1,2,2,1,2,1,4,2,4,1,2,1,1,2,3,4,4,1,4,2,3,4,2,1,2,1,3,2,2,2,1,4,3,2,1,4,4,4,3,4,1,1,4,1,1,4,2,4,4,2,4,4,2,1,4,1,3,4,1,1,4,1,2,2,2,1,4,2,1,4,1,1,4,2,3,3,1,3,3,2,4,4,4,3,3,2,1,1,2,4,3,1,2,4,1,3,4,4,2,2,2,2,4,1,1,4,1,1,4,2,3,3,4,3,2,2,2,2,2,3,1,4,1,4,3,3,2,3,4,4,4,2,2,2,2,3,2,1,4,1,1,1,2,1,1,2,1,4,1,1,3,2,4,4,2,4,3,1,2,4,2,4,4,1,2,2,4,2,2,2,4,2,4,2,4,2,2,4,1,2,4,2,2,4,3,2,4,2,3,2,1,4,2,4,3,2,4,1,4,1,3,4,3,3,1,3,3,2,2,3,3,1,3,2,1,3,3,1,1,2,1,3,3,4,4,3,1,1,2,1,3,4,2,4,1,2,2,2,4,2,2,2,4,4,1,3,2,1,3,3,3,1,1,2,4,1,2,4,2,2,2,1,2,2,2,4,3,3,1,3,2,2,4,2,2,3,4,1,3,1,2,2,4,1,1,2,2,1,4,2,4,4,2,4,2,2,4,4,1,2,1,2,2,4,1,3,2,1,3,3,4,3,4,2,4,2,2,4,2,4,1,4,2,4,4,1,3,3,3,3,2,2,1,4,2,1,1,4,4,4,2,1,4,2,1,2,1,1,2,1,1,4,4,1,4,2,1,1,4,1,4,1,1,1,1,2,2,2,2,2,4,3,2,2,1,4,1,1,2,2,2,1,1,4,1,2,2,1,1,1,2,3,2,2,2,2,4,2,4,4,2,3,4,2,4,3,1,4,2,2,3,4,2,2,4,1,1,4,2,1,2,1,3,2,1,3,4,2,2,4,1,2,4,4,2,4,2,2,4,1,4,2,4,2,4,2,2,2,1,3,4,2,2,4,1,3,2,4,3,2,4,3,3,2,1,4,2,1,2,4,1,4,1,2,4,1,2,4,1,1,2,1,3,1,2,2,3,2,1,1,2,2,4,2,1,1,2,1,2,2,1,2,2,4,4,2,4,4,2,3,1,2,2,2,2,3,2,2,3,3,1,3,3,1,3,3,1,3,1,2,2,2,2,1,4,4,2,4,1,4,1,2,2,1,1,2,1,2,2,4,1,4,4,2,4,3,1,4,4,4,4,4,2,3,3,4,2,1,2,2,2,4,3,1,1,3,4,4,4,1,4,1,4,4,2,4,4,1,4,2,2,4,1,2,2,1,3,3,2,4,4,2,3,3,1,1,4,1,1,4,2,4,2,2,2,1,4,1,4,4,3,4,1,1,2,4,4,1,2,4,1,2,4,2,2,3,3,1,1,1,1,1,1,1,3,1,1,2,2,1,4,4,4,3,3,1,4,1,2,1,4,1,3,3,4,1,4,3,3,4,2,4,3,1,3,2,4,1,4,3,1,4,1,4,2,1,1,4,4,3,3,2,4,4,2,2,4,1,3,3,3,4,4,4,1,4,2,3,4,3,4,3,1,3,2,1,2,1,2,2,1,4,1,4,1,4,4,4,1,2,1,3,4,1,3,3,1,1,4,1,3,1,2,3,4,1,3,1,2,1,2,1,2,3,1,3,2,1,4,1,4,4,4,2,1,2,2,4,2,2,3,2,4,1,2,2,1,4,1,1,4,2,1,4,2,3,2,4,1,4,2,2,2,2,1,2,2,3,3,2,3,4,2,1,1,1,3,4,1,4,4,4,1,3,2,4,3,1,2,4,2,3,2,2,1,2,1,2,4,2,2,1,2,3,3,1,1,3,2,1,1,4,1,4,3,1,1,1,4,3,1,4,2,4,3,2,4,3,2,1,3,4,3,2,4,2,4,3,1,3,2,2,2,4,1,3,3,1,4,4,2,1,4,2,4,4,4,2,4,4,4,4,2,1,2,2,3,4,1,3,3,4,3,3,2,2,4,3,1,2,4,3,3,2,1,4,4,3,4,1,4,4,1,3,2,1,1,1,2,4,2,1,4,2,1,2,4,1,3,1,2,1,4,2,3,4,1,2,4,1,2,1,2,3,1,2,1,2,3,4,1,2,4,1,2,3,4,4,3,4,1,3,2,4,2,1,2,4,4,2,2,1,2,4,1,4,3,4,2,2,4,1,4,2,1,1,4,1,3,3,1,3,2,4,3,4,1,4,4,4,3,2,2,1,4,2,1,4,1,3,3,1,3,3,2,4,4,2,1,4,4,2,1,2,4,3,1,4,4,4,2,2,2,2,4,1,4,4,2,4,2,1,3,3,2,4,1,2,1,2,2,2,4,1,3,1,2,2,1,1,1,2,2,4,1,2,3,2,2,1,1,1,1,4,2,2,1,4,4,4,2,1,2,4,1,4,2,1,4,1,4,4,2,1,4,2,3,3,2,3,4,1,1,1,4,2,4,1,1,2,4,4,4,2,4,4,2,2,2,1,2,1,1,2,1,2,4,4,4,2,4,2,3,3,2,2,4,1,4,2,2,3,3,1,1,4,3,2,2,2,2,3,1,2,3,4,4,1,2,4,2,3,3,1,2,4,1,2,2,2,2,3,1,4,3,2,1,4,1,2,1,2,2,1,2,1,4,3,1,1,1,2,1,4,2,2,4,1,4,2,1,4,2,4,3,4,1,3,3,2,4,2,1,4,4,2,1,4,4,4,2,4,2,4,1,1,2,1,3,2,1,3,4,1,1,4,1,4,4,1,1,4,1,1,4,4,4,4,2,1,4,3,1,4,4,4,3,1,3,1,1,3,2,2,4,4,2,3,2,4,4,2,3,1,1,3,2,3,1,1,1,1,3,4,2,2,4,1,1,4,1,3,4,1,3,1,1,3,1,1,2,2,2,4,2,2,1,4,1,1,1,2,2,4,3,3,1,3,4,3,1,2,4,1,4,1,4,3,3,1,4,3,2,2,2,2,2,2,1,2,2,2,4,1,2,2,1,2,1,2,1,4,4,2,3,1,1,3,1,1,2,2,2,3,4,1,4,1,2,1,4,1,1,1,1,4,2,4,1,3,1,2,1,1,1,1,1,1,3,3,1,1,3,3,1,1,4,2,3,1,1,2,2,2,2,2,2,1,1,1,3,2,4,3,3,4,4,4,2,1,1,3,2,2,1,1,2,2,2,2,1,4,3,3,2,2,4,2,2,1,4,3,1,2,4,4,4,4,4,2,1,1,1,1,1,3,3,4,1,4,4,1,3,1,1,1,1,1,2,2,1,4,4,4,2,1,4,1,1,2,4,4,4,3,4,2,1,1,1,3,4,4,1,1,1,4,4,1,4,1,3,3,2,4,1,1,1,4,2,2,4,1,4,1,4,1,4,2,4,4,1,1,4,3,3,2,1,2,1,4,3,2,1,3,2,3,2,1,1,3,4,1,3,3,4,2,4,1,2,1,1,3,1,2,3,2,4,1,2,4,4,2,2,2,2,4,1,4,2,1,4,1,3,1,1,3,1,3,2,4,4,1,4,2,1,2,2,4,4,4,2,1,4,3,1,4,2,1,2,3,2,2,2,4,2,1,4,1,1,4,2,1,4,4,4,4,2,2,4,4,1,4,2,4,3,2,4,4,2,2,4,1,3,4,2,2,4,3,4,1,4,3,2,2,2,4,4,4,4,2,2,4,1,1,2,1,2,4,2,1,2,1,1,2,1,1,1,1,2,4,1,1,2,4,1,1,4,1,2,4,1,1,2,1,4,2,4,2,1,3,1,2,3,2,4,2,1,3,3,1,1,1,4,1,3,1,1,1,2,2,3,4,2,4,3,1,1,2,4,1,4,2,2,4,3,2,2,2,3,2,2,1,4,2,1,4,2,2,4,1,3,4,2,2,4,2,1,4,2,3,2,2,2,4,2,2,2,1,4,2,2,2,4,1,2,3,2,1,4,2,2,4,4,4,1,2,1,4,1,1,2,1,3,1,2,3,1,3,3,4,2,1,1,2,3,1,4,2,2,2,4,2,2,2,4,4,1,2,2,1,4,2,1,1,1,4,2,1,1,4,4,3,3,2,2,1,2,2,1,1,4,3,3,4,1,2,4,3,1,1,2,2,4,1,2,3,1,3,4,1,2,1,2,2,3,1,2,4,1,2,3,3,2,3,3,1,2,4,1,1,4,2,4,4,2,1,1,2,4,2,2,4,1,2,1,4,1,2,4,4,2,2,2,2,2,1,4,4,1,4,4,2,2,4,1,3,1,1,2,2,1,3,3,2,3,1,2,2,4,3,2,3,1,2,4,2,2,4,4,3,1,2,3,4,4,3,1,2,1,1,4,2,3,1,3,4,1,3,4,1,2,4,2,2,2,3,1,4,4,3,1,1,3,2,2,2,2,2,1,4,4,2,3,4,1,4,1,1,4,1,1,4,4,1,2,1,4,2,1,2,1,1,3,1,2,3,4,2,4,4,3,2,1,2,4,2,1,4,3,1,3,2,4,3,4,2,2,2,2,1,2,1,4,4,1,3,3,2,4,4,1,1,1,1,1,2,1,3,1,4,3,2,1,1,4,4,2,2,2,3,3,1,2,3,4,2,4,1,1,1,2,2,1,1,1,2,2,1,2,4,4,4,2,1,2,2,3,2,4,1,2,1,2,3,1,2,2,3,3,3,3,3,4,1,4,1,2,4,1,2,3,3,4,2,1,1,4,3,2,4,2,4,3,1,1,1,4,2,4,3,4,3,3,1,3,2,1,1,1,2,2,1,2,1,3,4,4,4,2,1,4,3,2,2,2,1,4,2,3,4,2,2,4,1,3,1,1,4,4,1,1,4,4,2,2,2,2,4,1,1,1,1,1,4,2,4,4,4,3,1,1,1,4,1,3,3,3,2,2,2,3,4,1,4,4,4,1,2,2,2,4,1,4,1,3,2,1,2,2,2,2,2,4,2,4,1,2,2,2,2,2,4,2,4,1,3,1,3,2,2,2,1,2,4,3,4,1,1,1,3,2,4,1,1,2,4,4,1,3,2,1,4,4,1,1,2,2,4,4,4,4,1,1,3,4,4,1,1,1,3,1,4,4,1,1,3,1,3,1,1,2,2,1,1,2,1,2,2,4,2,4,4,4,1,2,1,3,4,3,1,1,1,4,3,2,2,2,2,1,1,2,4,1,1,1,4,1,2,4,1,2,2,3,4,1,4,3,3,2,2,2,1,2,2,1,4,1,1,4,4,1,2,2,2,2,2,1,4,1,2,4,2,2,4,4,1,2,1,2,4,1,4,4,2,2,4,2,1,4,2,1,2,2,2,1,1,2,4,1,1,1,1,1,4,1,4,4,1,1,1,2,1,2,1,1,1,2,4,1,2,2,1,2,2,4,1,2,2,4,2,2,2,4,2,1,2,2,1,1,1,3,2,2,2,1,4,1,1,1,1,1,4,1,1,1,1,1,1,4,4,1,4,1,1,2,1,1,1,2,2,2,4,3,1,3,1,1,2,2,1,1,1,1,4,3,1,1,2,3,1,1,1,1,4,2,4,3,4,4,2,3,2,4,4,2,1,4,4,2,1,4,4,3,2,2,2,2,2,1,2,1,1,4,2,2,4,1,3,3,2,2,4,1,2,2,2,3,2,2,3,2,1,3,4,1,2,4,3,1,4,2,1,4,4,2,4,1,4,4,4,2,2,2,2,2,4,2,4,1,4,4,3,1,4,2,2,2,2,1,2,2,4,2,2,1,1,1,4,1,4,2,4,2,1,4,2,1,1,2,1,1,2,2,3,1,2,4,1,1,4,2,1,2,2,1,2,2,2,1,1,2,1,1,4,3,1,2,4,1,1,4,2,1,1,1,2,4,1,1,2,2,4,2,1,1,1,1,2,1,1,1,4,3,1,4,1,3,2,2,1,4,1,2,1,2,1,1,2,1,2,4,1,1,1,3,3,1,2,3,1,1,2,2,4,3,1,4,2,4,2,4,4,1,4,1,2,4,1,3,4,1,4,2,2,4,4,1,1,4,2,1,4,4,4,4,4,1,4,4,3,2,2,1,2,1,1,2,4,1,1,2,2,4,2,2,4,2,3,3,1,2,4,2,2,4,3,2,2,4,2,1,2,4,2,1,4,4,4,1,2,1,2,2,1,1,2,2,1,2,2,2,1,1,2,4,1,4,2,4,1,4,1,1,1,2,2,4,1,3,2,2,1,4,3,3,2,2,1,4,2,2,2,2,4,4,1,4,3,1,3,2,3,3,3,2,3,2,1,3,4,3,1,4,4,1,4,1,3,3,2,4,4,4,2,3,2,4,2,4,1,1,3,1,4,4,1,1,1,1,1,4,3,2,2,2,4,1,3,2,2,2,1,2,4,4,2,4,4,1,2,2,1,2,1,1,3,3,2,1,2,1,2,2,4,1,2,1,2,2,2,2,4,4,1,4,2,2,2,2,1,4,1,2,4,1,3,4,4,1,4,4,1,4,2,3,1,1,1,2,2,1,4,2,1,3,2,2,4,1,2,4,2,1,4,4,2,1,1,2,2,1,1,4,1,3,2,2,2,4,3,3,2,2,3,4,1,2,3,2,2,4,1,1,2,2,3,2,4,1,1,2,1,4,4,1,2,4,3,2,1,3,3,2,2,1,2,2,4,1,2,4,2,1,4,3,2,1,2,2,4,1,1,4,4,3,3,1,1,3,2,3,2,2,1,2,2,2,4,1,3,2,1,1,4,1,4,2,1,1,2,2,1,4,4,1,1,2,2,4,4,2,2,2,4,2,4,1,2,1,2,4,4,1,4,2,1,4,2,4,4,2,1,2,1,1,4,4,2,4,1,1,4,4,2,4,1,2,4,3,1,2,4,1,4,2,2,4,1,3,1,1,1,4,2,3,2,4,3,4,2,3,2,2,4,4,1,1,4,2,2,1,1,3,2,2,4,1,2,3,4,4,4,4,2,1,2,1,2,4,4,2,4,1,3,4,1,1,3,2,2,4,2,4,1,2,2,4,3,2,1,2,3,1,2,1,1,2,1,2,1,4,1,1,4,3,1,2,2,2,1,2,2,1,1,4,2,1,2,1,4,3,2,2,4,1,4,2,1,4,1,4,1,3,4,1,1,1,1,2,2,2,1,3,2,2,2,1,4,3,1,2,2,2,2,4,1,1,2,1,3,3,3,3,2,2,2,4,2,4,2,1,3,2,2,2,4,2,2,4,1,1,4,3,1,2,2,4,2,2,3,3,2,2,4,1,3,2,2,1,4,3,4,3,1,4,4,4,2,1,2,4,4,2,2,1,2,4,2,2,1,4,1,1,2,3,2,4,2,2,4,2,1,4,1,2,4,1,3,3,2,2,4,1,2,4,1,1,2,2,1,1,2,1,2,1,2,4,1,1,2,2,1,4,1,4,1,2,2,1,1,4,3,3,4,3,3,2,3,2,3,1,4,3,4,1,1,2,1,2,3,1,3,1,1,1,3,2,1,2,1,4,1,2,2,1,1,3,3,2,2,1,2,2,1,2,1,2,1,2,2,1,2,2,4,3,4,2,2,1,1,1,1,1,3,3,2,2,4,4,2,3,1,4,1,2,3,3,3,1,4,1,1,4,2,2,4,1,4,4,4,1,4,4,1,2,2,4,2,1,3,1,1,3,4,4,4,4,4,4,4,2,4,4,2,3,2,1,3,3,1,4,4,4,4,4,2,4,3,1,3,2,2,4,4,4,4,1,2,2,1,2,4,2,2,1,3,2,2,4,1,3,2,2,2,2,4,1,2,2,2,2,2,2,1,1,2,4,1,3,3,1,3,3,3,2,1,2,4,3,3,2,2,2,2,2,1,1,2,1,3,3,2,1,4,2,1,2,2,2,2,3,2,4,1,1,1,4,2,2,2,2,4,1,3,1,1,3,4,2,2,2,1,2,4,2,2,4,1,1,1,2,1,2,1,4,2,2,3,4,1,4,4,1,2,4,2,3,2,1,4,2,1,3,3,1,3,4,1,4,2,1,1,4,2,1,2,2,4,3,1,3,2,4,2,1,2,2,1,4,1,3,4,2,4,1,1,4,1,3,1,1,1,1,2,1,1,2,2,3,1,1,1,2,2,1,1,1,4,1,1,4,4,2,1,1,3,2,1,2,4,3,2,4,4,1,4,4,1,2,1,1,4,4,4,4,1,2,4,3,3,3,4,2,4,2,4,1,4,4,4,4,1,2,2,2,4,2,2,4,1,2,1,1,3,2,2,4,2,1,3,1,3,4,1,2,4,4,2,3,1,3,4,2,4,2,2,2,4,4,2,1,2,2,1,4,4,4,2,2,3,1,2,3,3,2,1,4,2,4,1,2,3,3,2,4,2,1,1,2,1,4,4,4,4,4,4,3,4,1,3,2,2,1,2,1,3,3,2,4,4,2,2,1,2,3,3,1,2,4,4,2,1,2,3,4,2,1,4,4,1,4,4,3,3,2,4,2,1,1,2,4,4,4,2,2,4,2,1,2,4,1,4,2,4,3,2,4,4,2,1,4,2,2,3,2,2,1,1,2,4,1,1,4,1,4,4,4,2,1,2,4,4,4,1,2,1,4,2,2,1,1,1,2,1,4,2,1,2,4,4,4,3,3,2,4,4,2,3,1,1,3,2,2,3,2,2,3,2,2,4,3,1,4,1,2,4,3,3,2,1,4,4,4,4,3,4,1,3,1,4,3,4,3,3,4,4,4,3,1,2,4,1,4,4,4,2,4,3,4,1,4,3,4,2,4,2,2,1,4,2,4,1,4,4,3,1,4,3,1,3,3,3,4,2,4,4,1,2,4,2,4,4,4,4,1,3,4,1,4,1,1,1,4,1,3,4,1,2,2,3,4,4,1,1,2,4,4,2,2,1,1,4,4,1,1,2,4,1,3,4,4,4,4,3,1,2,1,1,2,1,4,4,2,1,1,1,1,1,1,3,1,3,4,1,1,4,1,1,1,2,4,4,2,3,2,2,4,4,1,1,4,4,4,4,1,1,4,1,1,4,2,1,1,2,1,2,2,2,4,2,2,4,1,3,2,2,4,4,1,2,4,1,2,4,1,1,4,1,1,4,4,1,4,4,1,2,1,4,4,4,4,3,1,2,4,1,2,2,1,2,1,1,2,4,2,1,1,2,3,3,2,4,1,2,1,4,1,3,1,1,1,1,1,4,2,2,1,2,2,2,2,4,4,1,2,3,1,3,4,3,2,3,3,2,4,4,2,3,1,2,2,2,4,1,4,1,4,2,2,2,2,2,3,2,2,2,3,2,3,4,0};
      buildBWTandTest(s,0, alphabet);
   }
   
   @Test
   public void testBuildDetWithDNA() {
      byte[][] s = { 
            {1,1,3,1,2,1,1,3,1,0,2,4,0,-1,-2},
            {1,1,3,1,2,1,1,3,1,2,0,-1,-2},
            {4,4,2,2,4,1,2,4,4,2,1,0,3,3,3,2,2,1,4,1,1,0,0,0,0,1,3,2,2,4,0,-1,-2},
            {4,4,2,2,4,1,2,4,4,0,2,1,3,3,3,2,2,1,4,1,1,1,3,2,2,4,0,-1,-2},
            {4,3,2,1,4,3,0,2,1,4,3,2,4,1,-1,3,2,4,1,3,2,4,4,4,2,3,1,3,2,4,1,4,0,-1,-2},
            {3,2,4,3,0,2,4,4,1,3,4,0,2,1,4,2,3,4,2,0,3,4,4,2,1,3,4,1,4,4,3,2,1,2,3,1,3,2,1,2,3,1,3,2,1,2,1,0,-1,-2},
            {4,3,1,4,3,2,4,1,2,1,3,2,1,2,3,1,4,2,3,4,1,2,0,3,4,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,0,-1,-2},
            {3,1,4,3,1,3,0,2,4,1,0,3,2,1,3,2,4,1,3,2,-1,1,2,3,4,1,3,2,1,3,2,4,0,-1,-2},
            {4,3,4,3,2,1,3,2,4,1,3,2,4,1,3,2,4,1,2,3,4,1,3,2,4,1,3,2,4,1,2,3,4,0,-1,-2},
            {4,3,2,1,4,3,2,1,2,3,2,3,4,3,2,1,3,2,4,2,3,1,0,-1,-2},
            {1,2,4,1,4,2,3,1,0,4,2,1,4,3,2,1,4,3,2,0,-1,-2},
            {-1,-1,-1,-2},
            {4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,-1,-2},
            {1,2,1,0,0,3,2,4,2,1,2,-1,2,1,4,4,4,-1,-1,4,4,4,-1,4,4,4,2,1,0,0,2,4,4,4-1,-2},
            {1,-1,0,3,1,-1,-2},
            {1,-1,0,4,1,-1,-2},
            {0,1,2,-1,-2},
            {0,4,2,-1,-2},
            {0,-1,-2},
            {4,-1,-2}
      };
      
      for (int si = 0; si < s.length; si++) {
         buildBWTandTest(s[si], si, Alphabet.DNA());
      }
   }
   
   @Test
   public void testBuildRandWithDNA() {
      byte[] s = null;

      Random rand = new Random(100);

      for (int si = 0; si < 50; si++) {
         s = new byte[500 + rand.nextInt(500)];

         for (int j = 0; j < s.length - 1; j++) {
            s[j] = (byte) (rand.nextInt(6) - 1);
         }
         s[s.length - 1] = -2;
         
         buildBWTandTest(s,si, Alphabet.DNA());
      }
   }
   
   @Test
   public void testBuildchrMWithDNA() {
      final byte[] s = {2,0,3,1,0,1,0,2,2,3,1,3,0,3,1,0,1,1,1,3,0,3,3,0,0,1,1,0,1,3,1,0,1,2,2,2,0,2,1,3,1,3,1,1,0,3,2,1,0,3,3,3,2,2,3,0,3,3,3,3,1,2,3,1,3,2,2,2,2,2,2,3,2,3,2,1,0,1,2,1,2,0,3,0,2,1,0,3,3,2,1,2,0,2,0,1,2,1,3,2,2,0,2,1,1,2,2,0,2,1,0,1,1,1,3,0,3,2,3,1,2,1,0,2,3,0,3,1,3,2,3,1,3,3,3,2,0,3,3,1,1,3,2,1,1,3,1,0,3,3,1,3,0,3,3,0,3,3,3,0,3,1,2,1,0,1,1,3,0,1,2,3,3,1,0,0,3,0,3,3,0,1,0,2,2,1,2,0,0,1,0,3,0,1,1,3,0,1,3,0,0,0,2,3,2,3,2,3,3,0,0,3,3,0,0,3,3,0,0,3,2,1,3,3,2,3,0,2,2,0,1,0,3,0,0,3,0,0,3,0,0,1,0,0,3,3,2,0,0,3,2,3,1,3,2,1,0,1,0,2,1,1,2,1,3,3,3,1,1,0,1,0,1,0,2,0,1,0,3,1,0,3,0,0,1,0,0,0,0,0,0,3,3,3,1,1,0,1,1,0,0,0,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,2,1,3,3,1,3,2,2,1,1,0,1,0,2,1,0,1,3,3,0,0,0,1,0,1,0,3,1,3,1,3,2,1,1,0,0,0,1,1,1,1,0,0,0,0,0,1,0,0,0,2,0,0,1,1,1,3,0,0,1,0,1,1,0,2,1,1,3,0,0,1,1,0,2,0,3,3,3,1,0,0,0,3,3,3,3,0,3,1,3,3,3,0,2,2,1,2,2,3,0,3,2,1,0,1,3,3,3,3,0,0,1,0,2,3,1,0,1,1,1,1,1,1,0,0,1,3,0,0,1,0,1,0,3,3,0,3,3,3,3,1,1,1,1,3,1,1,1,0,1,3,1,1,1,0,3,0,1,3,0,1,3,0,0,3,1,3,1,0,3,1,0,0,3,0,1,0,0,1,1,1,1,1,2,1,1,1,0,3,1,1,3,0,1,1,1,0,2,1,0,1,0,1,0,1,0,1,0,1,1,2,1,3,2,1,3,0,0,1,1,1,1,0,3,0,1,1,1,1,2,0,0,1,1,0,0,1,1,0,0,0,1,1,1,1,0,0,0,2,0,1,0,1,1,1,1,1,1,0,1,0,2,3,3,3,0,3,2,3,0,2,1,3,3,0,1,1,3,1,1,3,1,0,0,0,2,1,0,0,3,0,1,0,1,3,2,0,0,0,0,3,2,3,3,3,0,2,0,1,2,2,2,1,3,1,0,1,0,3,1,0,1,1,1,1,0,3,0,0,0,1,0,0,0,3,0,2,2,3,3,3,2,2,3,1,1,3,0,2,1,1,3,3,3,1,3,0,3,3,0,2,1,3,1,3,3,0,2,3,0,0,2,0,3,3,0,1,0,1,0,3,2,1,0,0,2,1,0,3,1,1,1,1,2,3,3,1,1,0,2,3,2,0,2,3,3,1,0,1,1,1,3,1,3,0,0,0,3,1,0,1,1,0,1,2,0,3,1,0,0,0,0,2,2,2,0,1,0,0,2,1,0,3,1,0,0,2,1,0,1,2,1,0,2,1,0,0,3,2,1,0,2,1,3,1,0,0,0,0,1,2,1,3,3,0,2,1,1,3,0,2,1,1,0,1,0,1,1,1,1,1,0,1,2,2,2,0,0,0,1,0,2,1,0,2,3,2,0,3,3,0,0,1,1,3,3,3,0,2,1,0,0,3,0,0,0,1,2,0,0,0,2,3,3,3,0,0,1,3,0,0,2,1,3,0,3,0,1,3,0,0,1,1,1,1,0,2,2,2,3,3,2,2,3,1,0,0,3,3,3,1,2,3,2,1,1,0,2,1,1,0,1,1,2,1,2,2,3,1,0,1,0,1,2,0,3,3,0,0,1,1,1,0,0,2,3,1,0,0,3,0,2,0,0,2,1,1,2,2,1,2,3,0,0,0,2,0,2,3,2,3,3,3,3,0,2,0,3,1,0,1,1,1,1,1,3,1,1,1,1,0,0,3,0,0,0,2,1,3,0,0,0,0,1,3,1,0,1,1,3,2,0,2,3,3,2,3,0,0,0,0,0,0,1,3,1,1,0,2,3,3,2,0,1,0,1,0,0,0,0,3,0,2,0,1,3,0,1,2,0,0,0,2,3,2,2,1,3,3,3,0,0,1,0,3,0,3,1,3,2,0,0,1,0,1,0,1,0,0,3,0,2,1,3,0,0,2,0,1,1,1,0,0,0,1,3,2,2,2,0,3,3,0,2,0,3,0,1,1,1,1,0,1,3,0,3,2,1,3,3,0,2,1,1,1,3,0,0,0,1,1,3,1,0,0,1,0,2,3,3,0,0,0,3,1,0,0,1,0,0,0,0,1,3,2,1,3,1,2,1,1,0,2,0,0,1,0,1,3,0,1,2,0,2,1,1,0,1,0,2,1,3,3,0,0,0,0,1,3,1,0,0,0,2,2,0,1,1,3,2,2,1,2,2,3,2,1,3,3,1,0,3,0,3,1,1,1,3,1,3,0,2,0,2,2,0,2,1,1,3,2,3,3,1,3,2,3,0,0,3,1,2,0,3,0,0,0,1,1,1,1,2,0,3,1,0,0,1,1,3,1,0,1,1,0,1,1,3,1,3,3,2,1,3,1,0,2,1,1,3,0,3,0,3,0,1,1,2,1,1,0,3,1,3,3,1,0,2,1,0,0,0,1,1,1,3,2,0,3,2,0,0,2,2,1,3,0,1,0,0,0,2,3,0,0,2,1,2,1,0,0,2,3,0,1,1,1,0,1,2,3,0,0,0,2,0,1,2,3,3,0,2,2,3,1,0,0,2,2,3,2,3,0,2,1,1,1,0,3,2,0,2,2,3,2,2,1,0,0,2,0,0,0,3,2,2,2,1,3,0,1,0,3,3,3,3,1,3,0,1,1,1,1,0,2,0,0,0,0,1,3,0,1,2,0,3,0,2,1,1,1,3,3,0,3,2,0,0,0,1,3,3,0,0,2,2,2,3,1,2,0,0,2,2,3,2,2,0,3,3,3,0,2,1,0,2,3,0,0,0,1,3,2,0,2,0,2,3,0,2,0,2,3,2,1,3,3,0,2,3,3,2,0,0,1,0,2,2,2,1,1,1,3,2,0,0,2,1,2,1,2,3,0,1,0,1,0,1,1,2,1,1,1,2,3,1,0,1,1,1,3,1,1,3,1,0,0,2,3,0,3,0,1,3,3,1,0,0,0,2,2,0,1,0,3,3,3,0,0,1,3,0,0,0,0,1,1,1,1,3,0,1,2,1,0,3,3,3,0,3,0,3,0,2,0,2,2,0,2,0,1,0,0,2,3,1,2,3,0,0,1,0,3,2,2,3,0,0,2,3,2,3,0,1,3,2,2,0,0,0,2,3,2,1,0,1,3,3,2,2,0,1,2,0,0,1,1,0,2,0,2,3,2,3,0,2,1,3,3,0,0,1,0,1,0,0,0,2,1,0,1,1,1,0,0,1,3,3,0,1,0,1,3,3,0,2,2,0,2,0,3,3,3,1,0,0,1,3,3,0,0,1,3,3,2,0,1,1,2,1,3,1,3,2,0,2,1,3,0,0,0,1,1,3,0,2,1,1,1,1,0,0,0,1,1,1,0,1,3,1,1,0,1,1,3,3,0,1,3,0,1,1,0,2,0,1,0,0,1,1,3,3,0,2,1,1,0,0,0,1,1,0,3,3,3,0,1,1,1,0,0,0,3,0,0,0,2,3,0,3,0,2,2,1,2,0,3,0,2,0,0,0,3,3,2,0,0,0,1,1,3,2,2,1,2,1,0,0,3,0,2,0,3,0,3,0,2,3,0,1,1,2,1,0,0,2,2,2,0,0,0,2,0,3,2,0,0,0,0,0,3,3,0,3,0,0,1,1,0,0,2,1,0,3,0,0,3,0,3,0,2,1,0,0,2,2,0,1,3,0,0,1,1,1,1,3,0,3,0,1,1,3,3,1,3,2,1,0,3,0,0,3,2,0,0,3,3,0,0,1,3,0,2,0,0,0,3,0,0,1,3,3,3,2,1,0,0,2,2,0,2,0,2,1,1,0,0,0,2,1,3,0,0,2,0,1,1,1,1,1,2,0,0,0,1,1,0,2,0,1,2,0,2,1,3,0,1,1,3,0,0,2,0,0,1,0,2,1,3,0,0,0,0,2,0,2,1,0,1,0,1,1,1,2,3,1,3,0,3,2,3,0,2,1,0,0,0,0,3,0,2,3,2,2,2,0,0,2,0,3,3,3,0,3,0,2,2,3,0,2,0,2,2,1,2,0,1,0,0,0,1,1,3,0,1,1,2,0,2,1,1,3,2,2,3,2,0,3,0,2,1,3,2,2,3,3,2,3,1,1,0,0,2,0,3,0,2,0,0,3,1,3,3,0,2,3,3,1,0,0,1,3,3,3,0,0,0,3,3,3,2,1,1,1,0,1,0,2,0,0,1,1,1,3,1,3,0,0,0,3,1,1,1,1,3,3,2,3,0,0,0,3,3,3,0,0,1,3,2,3,3,0,2,3,1,1,0,0,0,2,0,2,2,0,0,1,0,2,1,3,1,3,3,3,2,2,0,1,0,1,3,0,2,2,0,0,0,0,0,0,1,1,3,3,2,3,0,2,0,2,0,2,0,2,3,0,0,0,0,0,0,3,3,3,0,0,1,0,1,1,1,0,3,0,2,3,0,2,2,1,1,3,0,0,0,0,2,1,0,2,1,1,0,1,1,0,0,3,3,0,0,2,0,0,0,2,1,2,3,3,1,0,0,2,1,3,1,0,0,1,0,1,1,1,0,1,3,0,1,1,3,0,0,0,0,0,0,3,1,1,1,0,0,0,1,0,3,0,3,0,0,1,3,2,0,0,1,3,1,1,3,1,0,1,0,1,1,1,0,0,3,3,2,2,0,1,1,0,0,3,1,3,0,3,1,0,1,1,1,3,0,3,0,2,0,0,2,0,0,1,3,0,0,3,2,3,3,0,2,3,0,3,0,0,2,3,0,0,1,0,3,2,0,0,0,0,1,0,3,3,1,3,1,1,3,1,1,2,1,0,3,0,0,2,1,1,3,2,1,2,3,1,0,2,0,3,1,0,0,0,0,1,0,1,3,2,0,0,1,3,2,0,1,0,0,3,3,0,0,1,0,2,1,1,1,0,0,3,0,3,1,3,0,1,0,0,3,1,0,0,1,1,0,0,1,0,0,2,3,1,0,3,3,0,3,3,0,1,1,1,3,1,0,1,3,2,3,1,0,0,1,1,1,0,0,1,0,1,0,2,2,1,0,3,2,1,3,1,0,3,0,0,2,2,0,0,0,2,2,3,3,0,0,0,0,0,0,0,2,3,0,0,0,0,2,2,0,0,1,3,1,2,2,1,0,0,0,1,1,3,3,0,1,1,1,1,2,1,1,3,2,3,3,3,0,1,1,0,0,0,0,0,1,0,3,1,0,1,1,3,1,3,0,2,1,0,3,1,0,1,1,0,2,3,0,3,3,0,2,0,2,2,1,0,1,1,2,1,1,3,2,1,1,1,0,2,3,2,0,1,0,1,0,3,2,3,3,3,0,0,1,2,2,1,1,2,1,2,2,3,0,1,1,1,3,0,0,1,1,2,3,2,1,0,0,0,2,2,3,0,2,1,0,3,0,0,3,1,0,1,3,3,2,3,3,1,1,3,3,0,0,0,3,0,2,2,2,0,1,1,3,2,3,0,3,2,0,0,3,2,2,1,3,1,1,0,1,2,0,2,2,2,3,3,1,0,2,1,3,2,3,1,3,1,3,3,0,1,3,3,3,3,0,0,1,1,0,2,3,2,0,0,0,3,3,2,0,1,1,3,2,1,1,1,2,3,2,0,0,2,0,2,2,1,2,2,2,1,0,3,2,0,1,0,1,0,2,1,0,0,2,0,1,2,0,2,0,0,2,0,1,1,1,3,0,3,2,2,0,2,1,3,3,3,0,0,3,3,3,0,3,3,0,0,3,2,1,0,0,0,1,0,2,3,0,1,1,3,0,0,1,0,0,0,1,1,1,0,1,0,2,2,3,1,1,3,0,0,0,1,3,0,1,1,0,0,0,1,1,3,2,1,0,3,3,0,0,0,0,0,3,3,3,1,2,2,3,3,2,2,2,2,1,2,0,1,1,3,1,2,2,0,2,1,0,2,0,0,1,1,1,0,0,1,1,3,1,1,2,0,2,1,0,2,3,0,1,0,3,2,1,3,0,0,2,0,1,3,3,1,0,1,1,0,2,3,1,0,0,0,2,1,2,0,0,1,3,0,1,3,0,3,0,1,3,1,0,0,3,3,2,0,3,1,1,0,0,3,0,0,1,3,3,2,0,1,1,0,0,1,2,2,0,0,1,0,0,2,3,3,0,1,1,1,3,0,2,2,2,0,3,0,0,1,0,2,1,2,1,0,0,3,1,1,3,0,3,3,1,3,0,2,0,2,3,1,1,0,3,0,3,1,0,0,1,0,0,3,0,2,2,2,3,3,3,0,1,2,0,1,1,3,1,2,0,3,2,3,3,2,2,0,3,1,0,2,2,0,1,0,3,1,1,1,2,0,3,2,2,3,2,1,0,2,1,1,2,1,3,0,3,3,0,0,0,2,2,3,3,1,2,3,3,3,2,3,3,1,0,0,1,2,0,3,3,0,0,0,2,3,1,1,3,0,1,2,3,2,0,3,1,3,2,0,2,3,3,1,0,2,0,1,1,2,2,0,2,3,0,0,3,1,1,0,2,2,3,1,2,2,3,3,3,1,3,0,3,1,3,0,1,3,3,1,0,0,0,3,3,1,1,3,1,1,1,3,2,3,0,1,2,0,0,0,2,2,0,1,0,0,2,0,2,0,0,0,3,0,0,2,2,1,1,3,0,1,3,3,1,0,1,0,0,0,2,1,2,1,1,3,3,1,1,1,1,1,2,3,0,0,0,3,2,0,3,0,3,1,0,3,1,3,1,0,0,1,3,3,0,2,3,0,3,3,0,3,0,1,1,1,0,1,0,1,1,1,0,1,1,1,0,0,2,0,0,1,0,2,2,2,3,3,3,2,3,3,0,0,2,0,3,2,2,1,0,2,0,2,1,1,1,2,2,3,0,0,3,1,2,1,0,3,0,0,0,0,1,3,3,0,0,0,0,1,3,3,3,0,1,0,2,3,1,0,2,0,2,2,3,3,1,0,0,3,3,1,1,3,1,3,3,1,3,3,0,0,1,0,0,1,0,3,0,1,1,1,0,3,2,2,1,1,0,0,1,1,3,1,1,3,0,1,3,1,1,3,1,0,3,3,2,3,0,1,1,1,0,3,3,1,3,0,0,3,1,2,1,0,0,3,2,2,1,0,3,3,1,1,3,0,0,3,2,1,3,3,0,1,1,2,0,0,1,2,0,0,0,0,0,3,3,1,3,0,2,2,1,3,0,3,0,3,0,1,0,0,1,3,0,1,2,1,0,0,0,2,2,1,1,1,1,0,0,1,2,3,3,2,3,0,2,2,1,1,1,1,3,0,1,2,2,2,1,3,0,1,3,0,1,0,0,1,1,1,3,3,1,2,1,3,2,0,1,2,1,1,0,3,0,0,0,0,1,3,1,3,3,1,0,1,1,0,0,0,2,0,2,1,1,1,1,3,0,0,0,0,1,1,1,2,1,1,0,1,0,3,1,3,0,1,1,0,3,1,0,1,1,1,3,1,3,0,1,0,3,1,0,1,1,2,1,1,1,1,2,0,1,1,3,3,0,2,1,3,1,3,1,0,1,1,0,3,1,2,1,3,1,3,3,1,3,0,1,3,0,3,2,0,0,1,1,1,1,1,1,3,1,1,1,1,0,3,0,1,1,1,0,0,1,1,1,1,1,3,2,2,3,1,0,0,1,1,3,1,0,0,1,1,3,0,2,2,1,1,3,1,1,3,0,3,3,3,0,3,3,1,3,0,2,1,1,0,1,1,3,1,3,0,2,1,1,3,0,2,1,1,2,3,3,3,0,1,3,1,0,0,3,1,1,3,1,3,2,0,3,1,0,2,2,2,3,2,0,2,1,0,3,1,0,0,0,1,3,1,0,0,0,1,3,0,1,2,1,1,1,3,2,0,3,1,2,2,1,2,1,0,1,3,2,1,2,0,2,1,0,2,3,0,2,1,1,1,0,0,0,1,0,0,3,1,3,1,0,3,0,3,2,0,0,2,3,1,0,1,1,1,3,0,2,1,1,0,3,1,0,3,3,1,3,0,1,3,0,3,1,0,0,1,0,3,3,0,1,3,0,0,3,0,0,2,3,2,2,1,3,1,1,3,3,3,0,0,1,1,3,1,3,1,1,0,1,1,1,3,3,0,3,1,0,1,0,0,1,0,1,0,0,2,0,0,1,0,1,1,3,1,3,2,0,3,3,0,1,3,1,1,3,2,1,1,0,3,1,0,3,2,0,1,1,1,3,3,2,2,1,1,0,3,0,0,3,0,3,2,0,3,3,3,0,3,1,3,1,1,0,1,0,1,3,0,2,1,0,2,0,2,0,1,1,0,0,1,1,2,0,0,1,1,1,1,1,3,3,1,2,0,1,1,3,3,2,1,1,2,0,0,2,2,2,2,0,2,3,1,1,2,0,0,1,3,0,2,3,1,3,1,0,2,2,1,3,3,1,0,0,1,0,3,1,2,0,0,3,0,1,2,1,1,2,1,0,2,2,1,1,1,1,3,3,1,2,1,1,1,3,0,3,3,1,3,3,1,0,3,0,2,1,1,2,0,0,3,0,1,0,1,0,0,0,1,0,3,3,0,3,3,0,3,0,0,3,0,0,0,1,0,1,1,1,3,1,0,1,1,0,1,3,0,1,0,0,3,1,3,3,1,1,3,0,2,2,0,0,1,0,0,1,0,3,0,3,2,0,1,2,1,0,1,3,1,3,1,1,1,1,3,2,0,0,1,3,1,3,0,1,0,1,0,0,1,0,3,0,3,3,3,3,2,3,1,0,1,1,0,0,2,0,1,1,1,3,0,1,3,3,1,3,0,0,1,1,3,1,1,1,3,2,3,3,1,3,3,0,3,2,0,0,3,3,1,2,0,0,1,0,2,1,0,3,0,1,1,1,1,1,2,0,3,3,1,1,2,1,3,0,1,2,0,1,1,0,0,1,3,1,0,3,0,1,0,1,1,3,1,1,3,0,3,2,0,0,0,0,0,0,1,3,3,1,1,3,0,1,1,0,1,3,1,0,1,1,1,3,0,2,1,0,3,3,0,1,3,3,0,3,0,3,2,0,3,0,3,2,3,1,3,1,1,0,3,0,1,1,1,0,3,3,0,1,0,0,3,1,3,1,1,0,2,1,0,3,3,1,1,1,1,1,3,1,0,0,0,1,1,3,0,0,2,0,0,0,3,0,3,2,3,1,3,2,0,3,0,0,0,0,2,0,2,3,3,0,1,3,3,3,2,0,3,0,2,0,2,3,0,0,0,3,0,0,3,0,2,2,0,2,1,3,3,0,0,0,1,1,1,1,1,3,3,0,3,3,3,1,3,0,2,2,0,1,3,0,3,2,0,2,0,0,3,1,2,0,0,1,1,1,0,3,1,1,1,3,2,0,2,0,0,3,1,1,0,0,0,0,3,3,1,3,1,1,2,3,2,1,1,0,1,1,3,0,3,1,0,1,0,1,1,1,1,0,3,1,1,3,0,0,0,2,3,0,0,2,2,3,1,0,2,1,3,0,0,0,3,0,0,2,1,3,0,3,1,2,2,2,1,1,1,0,3,0,1,1,1,1,2,0,0,0,0,3,2,3,3,2,2,3,3,0,3,0,1,1,1,3,3,1,1,1,2,3,0,1,3,0,0,3,3,0,0,3,1,1,1,1,3,2,2,1,1,1,0,0,1,1,1,2,3,1,0,3,1,3,0,1,3,1,3,0,1,1,0,3,1,3,3,3,2,1,0,2,2,1,0,1,0,1,3,1,0,3,1,0,1,0,2,1,2,1,3,0,0,2,1,3,1,2,1,0,1,3,2,0,3,3,3,3,3,3,0,1,1,3,2,0,2,3,0,2,2,1,1,3,0,2,0,0,0,3,0,0,0,1,0,3,2,1,3,0,2,1,3,3,3,3,0,3,3,1,1,0,2,3,3,1,3,0,0,1,1,0,0,0,0,0,0,0,3,0,0,0,1,1,1,3,1,2,3,3,1,1,0,1,0,2,0,0,2,1,3,2,1,1,0,3,1,0,0,2,3,0,3,3,3,1,1,3,1,0,1,2,1,0,0,2,1,0,0,1,1,2,1,0,3,1,1,0,3,0,0,3,1,1,3,3,1,3,0,0,3,0,2,1,3,0,3,1,1,3,1,3,3,1,0,0,1,0,0,3,0,3,0,1,3,1,3,1,1,2,2,0,1,0,0,3,2,0,0,1,1,0,3,0,0,1,1,0,0,3,0,1,3,0,1,1,0,0,3,1,0,0,3,0,1,3,1,0,3,1,0,3,3,0,0,3,0,0,3,1,0,3,0,0,3,2,2,1,3,0,3,0,2,1,0,0,3,0,0,0,0,1,3,0,2,2,0,0,3,0,2,1,1,1,1,1,3,3,3,1,0,1,3,3,1,3,2,0,2,3,1,1,1,0,2,0,2,2,3,3,0,1,1,1,0,0,2,2,1,0,1,1,1,1,3,1,3,2,0,1,0,3,1,1,2,2,1,1,3,2,1,3,3,1,3,3,1,3,1,0,1,0,3,2,0,1,0,0,0,0,0,1,3,0,2,1,1,1,1,1,0,3,1,3,1,0,0,3,1,0,3,0,3,0,1,1,0,0,0,3,1,3,1,3,1,1,1,3,1,0,1,3,0,0,0,1,2,3,0,0,2,1,1,3,3,1,3,1,1,3,1,0,1,3,1,3,1,3,1,0,0,3,1,3,3,0,3,1,1,0,3,1,0,3,0,2,1,0,2,2,1,0,2,3,3,2,0,2,2,3,2,2,0,3,3,0,0,0,1,1,0,0,0,1,1,1,0,2,1,3,0,1,2,1,0,0,0,0,3,1,3,3,0,2,1,0,3,0,1,3,1,1,3,1,0,0,3,3,0,1,1,1,0,1,0,3,0,2,2,0,3,2,0,0,3,0,0,3,0,2,1,0,2,3,3,1,3,0,1,1,2,3,0,1,0,0,1,1,1,3,0,0,1,0,3,0,0,1,1,0,3,3,1,3,3,0,0,3,3,3,0,0,1,3,0,3,3,3,0,3,0,3,3,0,3,1,1,3,0,0,1,3,0,1,3,0,1,1,2,1,0,3,3,1,1,3,0,1,3,0,1,3,1,0,0,1,3,3,0,0,0,1,3,1,1,0,2,1,0,1,1,0,1,2,0,1,1,1,3,0,1,3,0,1,3,0,3,1,3,1,2,1,0,1,1,3,2,0,0,0,1,0,0,2,1,3,0,0,1,0,3,2,0,1,3,0,0,1,0,1,1,1,3,3,0,0,3,3,1,1,0,3,1,1,0,1,1,1,3,1,1,3,1,3,1,1,1,3,0,2,2,0,2,2,1,1,3,2,1,1,1,1,1,2,1,3,0,0,1,1,2,2,1,3,3,3,3,3,2,1,1,1,0,0,0,3,2,2,2,1,1,0,3,3,0,3,1,2,0,0,2,0,0,3,3,1,0,1,0,0,0,0,0,0,1,0,0,3,0,2,1,1,3,1,0,3,1,0,3,1,1,1,1,0,1,1,0,3,1,0,3,0,2,1,1,0,1,1,0,3,1,0,1,1,1,3,1,1,3,3,0,0,1,1,3,1,3,0,1,3,3,1,3,0,1,1,3,0,1,2,1,1,3,0,0,3,1,3,0,1,3,1,1,0,1,1,3,1,0,0,3,1,0,1,0,1,3,0,1,3,1,1,1,1,0,3,0,3,1,3,0,0,1,0,0,1,2,3,0,0,0,0,0,3,0,0,0,0,3,2,0,1,0,2,3,3,3,2,0,0,1,0,3,0,1,0,0,0,0,1,1,1,0,1,1,1,1,0,3,3,1,1,3,1,1,1,1,0,1,0,1,3,1,0,3,1,2,1,1,1,3,3,0,1,1,0,1,2,1,3,0,1,3,1,1,3,0,1,1,3,0,3,1,3,1,1,1,1,3,3,3,3,0,3,0,1,3,0,0,3,0,0,3,1,3,3,0,3,0,2,0,0,0,3,3,3,0,2,2,3,3,0,0,0,3,0,1,0,2,0,1,1,0,0,2,0,2,1,1,3,3,1,0,0,0,2,1,1,1,3,1,0,2,3,0,0,2,3,3,2,1,0,0,3,0,1,3,3,0,0,3,3,3,1,3,2,1,0,0,1,0,2,1,3,0,0,2,2,0,1,3,2,1,0,0,0,0,1,1,1,1,0,1,3,1,3,2,1,0,3,1,0,0,1,3,2,0,0,1,2,1,0,0,0,3,1,0,2,1,1,0,1,3,3,3,0,0,3,3,0,0,2,1,3,0,0,2,1,1,1,3,3,0,1,3,0,2,0,1,1,0,0,3,2,2,2,0,1,3,3,0,0,0,1,1,1,0,1,0,0,0,1,0,1,3,3,0,2,3,3,0,0,1,0,2,1,3,0,0,2,1,0,1,1,1,3,0,0,3,1,0,0,1,3,2,2,1,3,3,1,0,0,3,1,3,0,1,3,3,1,3,1,1,1,2,1,1,2,1,1,2,2,2,0,0,0,0,0,0,2,2,1,2,2,2,0,2,0,0,2,1,1,1,1,2,2,1,0,2,2,3,3,3,2,0,0,2,1,3,2,1,3,3,1,3,3,1,2,0,0,3,3,3,2,1,0,0,3,3,1,0,0,3,0,3,2,0,0,0,0,3,1,0,1,1,3,1,2,2,0,2,1,3,2,2,3,0,0,0,0,0,2,0,2,2,1,1,3,0,0,1,1,1,1,3,2,3,1,3,3,3,0,2,0,3,3,3,0,1,0,2,3,1,1,0,0,3,2,1,3,3,1,0,1,3,1,0,2,1,1,0,3,3,3,3,0,1,1,3,1,0,1,1,1,1,1,0,1,3,2,0,3,2,3,3,1,2,1,1,2,0,1,1,2,3,3,2,0,1,3,0,3,3,1,3,1,3,0,1,0,0,0,1,1,0,1,0,0,0,2,0,1,0,3,3,2,2,0,0,1,0,1,3,0,3,0,1,1,3,0,3,3,0,3,3,1,2,2,1,2,1,0,3,2,0,2,1,3,2,2,0,2,3,1,1,3,0,2,2,1,0,1,0,2,1,3,1,3,0,0,2,1,1,3,1,1,3,3,0,3,3,1,2,0,2,1,1,2,0,2,1,3,2,2,2,1,1,0,2,1,1,0,2,2,1,0,0,1,1,3,3,1,3,0,2,2,3,0,0,1,2,0,1,1,0,1,0,3,1,3,0,1,0,0,1,2,3,3,0,3,1,2,3,1,0,1,0,2,1,1,1,0,3,2,1,0,3,3,3,2,3,0,0,3,0,0,3,1,3,3,1,3,3,1,0,3,0,2,3,0,0,3,0,1,1,1,0,3,1,0,3,0,0,3,1,2,2,0,2,2,1,3,3,3,2,2,1,0,0,1,3,2,0,1,3,0,2,3,3,1,1,1,1,3,0,0,3,0,0,3,1,2,2,3,2,1,1,1,1,1,2,0,3,0,3,2,2,1,2,3,3,3,1,1,1,1,2,1,0,3,0,0,0,1,0,0,1,0,3,0,0,2,1,3,3,1,3,2,0,1,3,1,3,3,0,1,1,3,1,1,1,3,1,3,1,3,1,1,3,0,1,3,1,1,3,2,1,3,1,2,1,0,3,1,3,2,1,3,0,3,0,2,3,2,2,0,2,2,1,1,2,2,0,2,1,0,2,2,0,0,1,0,2,2,3,3,2,0,0,1,0,2,3,1,3,0,1,1,1,3,1,1,1,3,3,0,2,1,0,2,2,2,0,0,1,3,0,1,3,1,1,1,0,1,1,1,3,2,2,0,2,1,1,3,1,1,2,3,0,2,0,1,1,3,0,0,1,1,0,3,1,3,3,1,3,1,1,3,3,0,1,0,1,1,3,0,2,1,0,2,2,3,2,3,1,3,1,1,3,1,3,0,3,1,3,3,0,2,2,2,2,1,1,0,3,1,0,0,3,3,3,1,0,3,1,0,1,0,0,1,0,0,3,3,0,3,1,0,0,3,0,3,0,0,0,0,1,1,1,1,1,3,2,1,1,0,3,0,0,1,1,1,0,0,3,0,1,1,0,0,0,1,2,1,1,1,1,3,1,3,3,1,2,3,1,3,2,0,3,1,1,2,3,1,1,3,0,0,3,1,0,1,0,2,1,0,2,3,1,1,3,0,1,3,3,1,3,1,1,3,0,3,1,3,1,3,1,1,1,0,2,3,1,1,3,0,2,1,3,2,1,3,2,2,1,0,3,1,0,1,3,0,3,0,1,3,0,1,3,0,0,1,0,2,0,1,1,2,1,0,0,1,1,3,1,0,0,1,0,1,1,0,1,1,3,3,1,3,3,1,2,0,1,1,1,1,2,1,1,2,2,0,2,2,0,2,2,0,2,0,1,1,1,1,0,3,3,1,3,0,3,0,1,1,0,0,1,0,1,1,3,0,3,3,1,3,2,0,3,3,3,3,3,1,2,2,3,1,0,1,1,1,3,2,0,0,2,3,3,3,0,3,0,3,3,1,3,3,0,3,1,1,3,0,1,1,0,2,2,1,3,3,1,2,2,0,0,3,0,0,3,1,3,1,1,1,0,3,0,3,3,2,3,0,0,1,3,3,0,1,3,0,1,3,1,1,2,2,0,0,0,0,0,0,0,2,0,0,1,1,0,3,3,3,2,2,0,3,0,1,0,3,0,2,2,3,0,3,2,2,3,1,3,2,0,2,1,3,0,3,2,0,3,0,3,1,0,0,3,3,2,2,1,3,3,1,1,3,0,2,2,2,3,3,3,0,3,1,2,3,2,3,2,0,2,1,0,1,0,1,1,0,3,0,3,0,3,3,3,0,1,0,2,3,0,2,2,0,0,3,0,2,0,1,2,3,0,2,0,1,0,1,0,1,2,0,2,1,0,3,0,3,3,3,1,0,1,1,3,1,1,2,1,3,0,1,1,0,3,0,0,3,1,0,3,1,2,1,3,0,3,1,1,1,1,0,1,1,2,2,1,2,3,1,0,0,0,2,3,0,3,3,3,0,2,1,3,2,0,1,3,1,2,1,1,0,1,0,1,3,1,1,0,1,2,2,0,0,2,1,0,0,3,0,3,2,0,0,0,3,2,0,3,1,3,2,1,3,2,1,0,2,3,2,1,3,1,3,2,0,2,1,1,1,3,0,2,2,0,3,3,1,0,3,1,3,3,3,1,3,3,3,3,1,0,1,1,2,3,0,2,2,3,2,2,1,1,3,2,0,1,3,2,2,1,0,3,3,2,3,0,3,3,0,2,1,0,0,0,1,3,1,0,3,1,0,1,3,0,2,0,1,0,3,1,2,3,0,1,3,0,1,0,1,2,0,1,0,1,2,3,0,1,3,0,1,2,3,3,2,3,0,2,1,3,1,0,1,3,3,1,1,0,1,3,0,3,2,3,1,1,3,0,3,1,0,0,3,0,2,2,0,2,1,3,2,3,0,3,3,3,2,1,1,0,3,1,0,3,0,2,2,0,2,2,1,3,3,1,0,3,3,1,0,1,3,2,0,3,3,3,1,1,1,1,3,0,3,3,1,3,1,0,2,2,1,3,0,1,0,1,1,1,3,0,2,0,1,1,0,0,0,1,1,3,0,1,2,1,1,0,0,0,0,3,1,1,0,3,3,3,1,0,1,3,0,3,1,0,3,0,3,3,1,0,3,1,2,2,1,2,3,0,0,0,3,1,3,0,0,1,3,3,3,1,3,3,1,1,1,0,1,0,0,1,0,1,3,3,3,1,3,1,2,2,1,1,3,0,3,1,1,2,2,0,0,3,2,1,1,1,1,2,0,1,2,3,3,0,1,3,1,2,2,0,1,3,0,1,1,1,1,2,0,3,2,1,0,3,0,1,0,1,1,0,1,0,3,2,0,0,0,1,0,3,1,1,3,0,3,1,0,3,1,3,2,3,0,2,2,1,3,1,0,3,3,1,0,3,3,3,1,3,1,3,0,0,1,0,2,1,0,2,3,0,0,3,0,3,3,0,0,3,0,0,3,3,3,3,1,0,3,2,0,3,3,3,2,0,2,0,0,2,1,1,3,3,1,2,1,3,3,1,2,0,0,2,1,2,0,0,0,0,2,3,1,1,3,0,0,3,0,2,3,0,2,0,0,2,0,0,1,1,1,3,1,1,0,3,0,0,0,1,1,3,2,2,0,2,3,2,0,1,3,0,3,0,3,2,2,0,3,2,1,1,1,1,1,1,0,1,1,1,3,0,1,1,0,1,0,1,0,3,3,1,2,0,0,2,0,0,1,1,1,2,3,0,3,0,1,0,3,0,0,0,0,3,1,3,0,2,0,1,0,0,0,0,0,0,2,2,0,0,2,2,0,0,3,1,2,0,0,1,1,1,1,1,1,0,0,0,2,1,3,2,2,3,3,3,1,0,0,2,1,1,0,0,1,1,1,1,0,3,2,2,1,1,3,1,1,0,3,2,0,1,3,3,3,3,3,1,0,0,0,0,0,2,2,3,0,3,3,0,2,0,0,0,0,0,1,1,0,3,3,3,1,0,3,0,0,1,3,3,3,2,3,1,0,0,0,2,3,3,0,0,0,3,3,0,3,0,2,2,1,3,0,0,0,3,1,1,3,0,3,0,3,0,3,1,3,3,0,0,3,2,2,1,0,1,0,3,2,1,0,2,1,2,1,0,0,2,3,0,2,2,3,1,3,0,1,0,0,2,0,1,2,1,3,0,1,3,3,1,1,1,1,3,0,3,1,0,3,0,2,0,0,2,0,2,1,3,3,0,3,1,0,1,1,3,3,3,1,0,3,2,0,3,1,0,1,2,1,1,1,3,1,0,3,0,0,3,1,0,3,3,3,3,1,1,3,3,0,3,1,3,2,1,3,3,1,1,3,0,2,3,1,1,3,2,3,0,3,2,1,1,1,3,3,3,3,1,1,3,0,0,1,0,1,3,1,0,1,0,0,1,0,0,0,0,1,3,0,0,1,3,0,0,3,0,1,3,0,0,1,0,3,1,3,1,0,2,0,1,2,1,3,1,0,2,2,0,0,0,3,0,2,0,0,0,1,1,2,3,1,3,2,0,0,1,3,0,3,1,1,3,2,1,1,1,2,1,1,0,3,1,0,3,1,1,3,0,2,3,1,1,3,1,0,3,1,2,1,1,1,3,1,1,1,0,3,1,1,1,3,0,1,2,1,0,3,1,1,3,3,3,0,1,0,3,0,0,1,0,2,0,1,2,0,2,2,3,1,0,0,1,2,0,3,1,1,1,3,1,1,1,3,3,0,1,1,0,3,1,0,0,0,3,1,0,0,3,3,2,2,1,1,0,1,1,0,0,3,2,2,3,0,1,3,2,0,0,1,1,3,0,1,2,0,2,3,0,1,0,1,1,2,0,1,3,0,1,2,2,1,2,2,0,1,3,0,0,3,1,3,3,1,0,0,1,3,1,1,3,0,1,0,3,0,1,3,3,1,1,1,1,1,0,3,3,0,3,3,1,1,3,0,2,0,0,1,1,0,2,2,1,2,0,1,1,3,2,1,2,0,1,3,1,1,3,3,2,0,1,2,3,3,2,0,1,0,0,3,1,2,0,2,3,0,2,3,0,1,3,1,1,1,2,0,3,3,2,0,0,2,1,1,1,1,1,0,3,3,1,2,3,0,3,0,0,3,0,0,3,3,0,1,0,3,1,0,1,0,0,2,0,1,2,3,1,3,3,2,1,0,1,3,1,0,3,2,0,2,1,3,2,3,1,1,1,1,0,1,0,3,3,0,2,2,1,3,3,0,0,0,0,0,1,0,2,0,3,2,1,0,0,3,3,1,1,1,2,2,0,1,2,3,1,3,0,0,0,1,1,0,0,0,1,1,0,1,3,3,3,1,0,1,1,2,1,3,0,1,0,1,2,0,1,1,2,2,2,2,2,3,0,3,0,1,3,0,1,2,2,3,1,0,0,3,2,1,3,1,3,2,0,0,0,3,1,3,2,3,2,2,0,2,1,0,0,0,1,1,0,1,0,2,3,3,3,1,0,3,2,1,1,1,0,3,1,2,3,1,1,3,0,2,0,0,3,3,0,0,3,3,1,1,1,1,3,0,0,0,0,0,3,1,3,3,3,2,0,0,0,3,0,2,2,2,1,1,1,2,3,0,3,3,3,0,1,1,1,3,0,3,0,2,1,0,1,1,1,1,1,3,1,3,0,1,1,1,1,1,3,1,3,0,2,0,2,1,1,1,0,1,3,2,3,0,0,0,2,1,3,0,0,1,3,3,0,2,1,0,3,3,0,0,1,1,3,3,3,3,0,0,2,3,3,0,0,0,2,0,3,3,0,0,2,0,2,0,0,1,1,0,0,1,0,1,1,3,1,3,3,3,0,1,0,2,3,2,0,0,0,3,2,1,1,1,1,0,0,1,3,0,0,0,3,0,1,3,0,1,1,2,3,0,3,2,2,1,1,1,0,1,1,0,3,0,0,3,3,0,1,1,1,1,1,0,3,0,1,3,1,1,3,3,0,1,0,1,3,0,3,3,1,1,3,1,0,3,1,0,1,1,1,0,0,1,3,0,0,0,0,0,3,0,3,3,0,0,0,1,0,1,0,0,0,1,3,0,1,1,0,1,1,3,0,1,1,3,1,1,1,3,1,0,1,1,0,0,0,2,1,1,1,0,3,0,0,0,0,0,3,0,0,0,0,0,0,3,3,0,3,0,0,1,0,0,0,1,1,1,3,2,0,2,0,0,1,1,0,0,0,0,3,2,0,0,1,2,0,0,0,0,3,1,3,2,3,3,1,2,1,3,3,1,0,3,3,1,0,3,3,2,1,1,1,1,1,0,1,0,0,3,1,1,3,0,2,2,1,1,3,0,1,1,1,2,1,1,2,1,0,2,3,0,1,3,2,0,3,1,0,3,3,1,3,0,3,3,3,1,1,1,1,1,3,1,3,0,3,3,2,0,3,1,1,1,1,0,1,1,3,1,1,0,0,0,3,0,3,1,3,1,0,3,1,0,0,1,0,0,1,1,2,0,1,3,0,0,3,1,0,1,1,0,1,1,1,0,0,1,0,0,3,2,0,1,3,0,0,3,1,0,0,0,1,3,0,0,1,1,3,1,0,0,0,0,1,0,0,0,3,2,0,3,0,2,1,1,0,3,0,1,0,1,0,0,1,0,1,3,0,0,0,2,2,0,1,2,0,0,1,1,3,2,0,3,1,3,1,3,3,0,3,0,1,3,0,2,3,0,3,1,1,3,3,0,0,3,1,0,3,3,3,3,3,0,3,3,2,1,1,0,1,0,0,1,3,0,0,1,1,3,1,1,3,1,2,2,0,1,3,1,1,3,2,1,1,3,1,0,1,3,1,0,3,3,3,0,1,0,1,1,0,0,1,1,0,1,1,1,0,0,1,3,0,3,1,3,0,3,0,0,0,1,1,3,0,2,1,1,0,3,2,2,1,1,0,3,1,1,1,1,3,3,0,3,2,0,2,1,2,2,2,1,2,1,0,2,3,2,0,3,3,0,3,0,2,2,1,3,3,3,1,2,1,3,1,3,0,0,2,0,3,3,0,0,0,0,0,3,2,1,1,1,3,0,2,1,1,1,0,1,3,3,1,3,3,0,1,1,0,1,0,0,2,2,1,0,1,0,1,1,3,0,1,0,1,1,1,1,3,3,0,3,1,1,1,1,0,3,0,1,3,0,2,3,3,0,3,3,0,3,1,2,0,0,0,1,1,0,3,1,0,2,1,1,3,0,1,3,1,0,3,3,1,0,0,1,1,0,0,3,0,2,1,1,1,3,2,2,1,1,2,3,0,1,2,1,1,3,0,0,1,1,2,1,3,0,0,1,0,3,3,0,1,3,2,1,0,2,2,1,1,0,1,1,3,0,1,3,1,0,3,2,1,0,1,1,3,0,0,3,3,2,2,0,0,2,1,2,1,1,0,1,1,1,3,0,2,1,0,0,3,0,3,1,0,0,1,1,0,3,3,0,0,1,1,3,3,1,1,1,3,1,3,0,1,0,1,3,3,0,3,1,0,3,1,3,3,1,0,1,0,0,3,3,1,3,0,0,3,3,1,3,0,1,3,2,0,1,3,0,3,1,1,3,0,2,0,0,0,3,1,2,1,3,2,3,1,2,1,1,3,3,0,0,3,1,1,0,0,2,1,1,3,0,1,2,3,3,3,3,1,0,1,0,1,3,3,1,3,0,2,3,0,0,2,1,1,3,1,3,0,1,1,3,2,1,0,1,2,0,1,0,0,1,0,1,0,3,0,0,3,2,0,1,1,1,0,1,1,0,0,3,1,0,1,0,3,2,1,1,3,0,3,1,0,3,0,3,0,2,3,0,0,0,0,1,1,1,0,2,1,1,1,0,3,2,0,1,1,1,1,3,0,0,1,0,2,2,2,2,1,1,1,3,1,3,1,0,2,1,1,1,3,1,1,3,0,0,3,2,0,1,1,3,1,1,2,2,1,1,3,0,2,1,1,0,3,2,3,2,0,3,3,3,1,0,1,3,3,1,1,0,1,3,1,1,0,3,0,0,1,2,1,3,1,1,3,1,0,3,0,1,3,0,2,2,1,1,3,0,1,3,0,0,1,1,0,0,1,0,1,0,1,3,0,0,1,1,0,3,0,3,0,1,1,0,0,3,2,2,3,2,2,1,2,1,2,0,3,2,3,0,0,1,0,1,2,0,2,0,0,0,2,1,0,1,0,3,0,1,1,0,0,2,2,1,1,0,1,1,0,1,0,1,0,1,1,0,1,1,3,2,3,1,1,0,0,0,0,0,2,2,1,1,3,3,1,2,0,3,0,1,2,2,2,0,3,0,0,3,1,1,3,0,3,3,3,0,3,3,0,1,1,3,1,0,2,0,0,2,3,3,3,3,3,3,3,1,3,3,1,2,1,0,2,2,0,3,3,3,3,3,1,3,2,0,2,1,1,3,3,3,3,0,1,1,0,1,3,1,1,0,2,1,1,3,0,2,1,1,1,1,3,0,1,1,1,1,1,1,0,0,1,3,0,2,2,0,2,2,2,1,0,1,3,2,2,1,1,1,1,1,0,0,1,0,2,2,1,0,3,1,0,1,1,1,1,2,1,3,0,0,0,3,1,1,1,1,3,0,2,0,0,2,3,1,1,1,0,1,3,1,1,3,0,0,0,1,0,1,0,3,1,1,2,3,0,3,3,0,1,3,1,2,1,0,3,1,0,2,2,0,2,3,0,3,1,0,0,3,1,0,1,1,3,2,0,2,1,3,1,0,1,1,0,3,0,2,3,1,3,0,0,3,0,2,0,0,0,0,1,0,0,1,1,2,0,0,0,1,1,0,0,0,3,0,0,3,3,1,0,0,2,1,0,1,3,2,1,3,3,0,3,3,0,1,0,0,3,3,3,3,0,1,3,2,2,2,3,1,3,1,3,0,3,3,3,3,0,1,1,1,3,1,1,3,0,1,0,0,2,1,1,3,1,0,2,0,2,3,0,1,3,3,1,2,0,2,3,1,3,1,1,1,3,3,1,0,1,1,0,3,3,3,1,1,2,0,1,2,2,1,0,3,1,3,0,1,2,2,1,3,1,0,0,1,0,3,3,3,3,3,3,2,3,0,2,1,1,0,1,0,2,2,1,3,3,1,1,0,1,2,2,0,1,3,3,1,0,1,2,3,1,0,3,3,0,3,3,2,2,1,3,1,0,0,1,3,3,3,1,1,3,1,0,1,3,0,3,1,3,2,1,3,3,1,0,3,1,1,2,1,1,0,0,1,3,0,0,3,0,3,3,3,1,0,1,3,3,3,0,1,0,3,1,1,0,0,0,1,0,3,1,0,1,3,3,3,2,2,1,3,3,1,2,0,0,2,1,1,2,1,1,2,1,1,3,2,0,3,0,1,3,2,2,1,0,3,3,3,3,2,3,0,2,0,3,2,3,2,2,3,3,3,2,0,1,3,0,3,3,3,1,3,2,3,0,3,2,3,1,3,1,1,0,3,1,3,0,3,3,2,0,3,2,0,2,2,2,3,1,3,3,0,1,3,1,3,3,3,3,0,2,3,0,3,0,0,0,3,0,2,3,0,1,1,2,3,3,0,0,1,3,3,1,1,0,0,3,3,0,0,1,3,0,2,3,3,3,3,2,0,1,0,0,1,0,3,3,1,0,0,0,0,0,0,2,0,2,3,0,0,3,0,0,0,1,3,3,1,2,1,1,3,3,0,0,3,3,3,3,0,0,3,0,0,3,1,0,0,1,0,1,1,1,3,1,1,3,0,2,1,1,3,3,0,1,3,0,1,3,0,0,3,0,0,3,3,0,3,3,0,1,0,3,3,3,3,2,0,1,3,0,1,1,0,1,0,0,1,3,1,0,0,1,2,2,1,3,0,1,0,3,0,2,0,0,0,0,0,3,1,1,0,1,1,1,1,3,3,0,1,2,0,2,3,2,1,2,2,1,3,3,1,2,0,1,1,1,3,0,3,0,3,1,1,1,1,1,2,1,1,1,2,1,2,3,0,-1,-2};
      buildBWTandTest(s,0, Alphabet.DNA());
   }
   
   /**
    * Builds a BWT-Index of s and checks the correctness.
    * 
    * @param s
    *           Sequence to build the index for.
    * @param nr
    *           Number of the actual test case. Is printed when an error occurs.
    */
   private void buildBWTandTest(byte[] s, int nr , Alphabet alphabet) {
      if (nr == 11) {
         System.out.println();
      }
      Sequences sequence = Sequences.createEmptySequencesInMemory();
      try {
         sequence.addSequence(ByteBuffer.wrap(s));
      } catch (IOException e) {
         e.printStackTrace();
      }

      final SuffixTrayBuilder stb = new SuffixTrayBuilder(sequence, alphabet, "suffix");
      stb.build("bothLR"); // WARNING: change the method and you must change the type cast in the
      // next line!
      assert (stb.getSuffixDLL() instanceof SuffixXorDLL);
      final SuffixXorDLL suffixDLL = (SuffixXorDLL) stb.getSuffixDLL(); // type cast is okay
      // because I used method
      // 'bothLR' to build the
      // list

      // test index
      bwt(s);
      BWTBuilder.BWT bwt = BWTBuilder.build(suffixDLL);
      BWTIndex index = BWTIndexBuilder.build(bwt.bwt, bwt.sampledSuffixArray);
      for (int i = -128; i < 128; i++) {
         assertEquals(String.format(
               "[Test %d] Array 'c' differs at position %s (expected: %s - actual: %s)", nr, i,
               c[i + 128], index.getFirstIndexPosition((byte) i)), c[i + 128],
               index.getFirstIndexPosition((byte) i));
      }
      
      if (nr == 11) {
         System.out.println(Arrays.toString(s));
         for (int i = 0; i < e.length; i++) {
            System.out.print(index.getCharacterAtIndexPosition(i));
         }
         System.out.println();
      }

      for (int i = 0; i < e.length; i++) {
         assertEquals(String.format(
               "[Test %d] Array 'e' differs at position %s (expected: %s - actual: %s)", nr, i,
               e[i], index.getCharacterAtIndexPosition(i)), e[i],
               index.getCharacterAtIndexPosition(i));
      }
      
//         System.out.println(Arrays.toString(e));
//         for (int i = 0; i < el.length; i++) {
//            System.out.print(index.getSuccedingIndexPosition(i) + " ");
//         }
//         System.out.println();

      for (int i = 0; i < el.length; i++) {
         assertEquals(String.format(
               "[Test %d] Array 'el' differs at position %s (expected: %s - actual: %s)", nr, i,
               el[i], index.getSuccedingIndexPosition(i)), el[i],
               index.getSuccedingIndexPosition(i));
      }
      for (int i = 0; i < e.length; i++)  {
         int sequencePos = index.map2text(i);
         assertEquals(
               String.format(
                     "[Test %d] Wrong mapping to text at index position %s (index.getSuccedingIndexPosition(i) = %d)",
                     nr, i, sequencePos), index.getCharacterAtIndexPosition(i),
               sequence.array()[sequencePos]);
      }
   }
   
   // here are results of bwt(byte[]) stored. 
   private static int[] c;
   private static byte[] e;
   private static int[] el;
   
   /**
    * Builds a BWT-Index from seq and stores the corresponding structure in c, e and el.
    * @param seq
    */
   public static void bwt(final byte[] seq) {
      byte[][] bwt_matrix = new byte[seq.length][];
      
      bwt_matrix[0] = Arrays.copyOf(seq, seq.length);
      for (int i = 1; i < bwt_matrix.length; i++) {
         bwt_matrix[i] = new byte[seq.length];
         int j;
         for(j = 0; j < seq.length-1; j++) {
            bwt_matrix[i][j] = bwt_matrix[i-1][j+1];
         }
         bwt_matrix[i][j] = bwt_matrix[i-1][0];
      }
      
      Arrays.sort(bwt_matrix, new ComparatorBySuffix());
      
      e = new byte[bwt_matrix.length];
      byte[] l = new byte[bwt_matrix.length];
      for (int i = 0; i < bwt_matrix.length; i++) {
         l[i] = bwt_matrix[i][bwt_matrix[i].length-1];
         e[i] = bwt_matrix[i][0];
      }
      
      int[] counter = new int [256];
      for (byte b: e) {
         counter[b+128]++;
      }
      
      c = new int[256];
      c[0] = 0;
      for(int i = 1; i < c.length; i++) {
         c[i] = c[i-1] + counter[i-1];
      }
      
      counter = Arrays.copyOf(c, c.length);
      
      el = new int[e.length];
      for(int i = 0; i < l.length; i++) {
         final byte b = l[i];
         final int bi = b + 128;
         el[counter[bi]] = i;
         counter[bi]++;
      }
      
      //check el array:
      for(int i = 0; i < el.length; i++) {
         final byte[] tmp = new byte[bwt_matrix[i].length];
         for (int j = 1; j < bwt_matrix[i].length; j++) {
            tmp[j-1] = bwt_matrix[i][j];
         }
         tmp[tmp.length-1] = bwt_matrix[i][0];
         assertArrayEquals(String.format("Failure in el reference array at position %d", i), tmp, bwt_matrix[el[i]]);
      }
   }
   
   /**
    * Compares two byte arrays character by character lexicographically. Even special characters are
    * compared lexicographically.
    */
   static class ComparatorBySuffix implements Comparator<byte[]> {

      /**
       * Compares two byte arrays and calculates the lcp value (longest common prefix).<br>
       * If 0 is returned, both arrays are the same.<br>
       * If -i (a negative integer) is returned, the first arrays stands before the second in a
       * suffix array. The lcp value is '(i-1)'.<br>
       * If i (a positive integer) is returned, the first suffix stands behind the second in a suffix
       * array. The lcp value is '(i-1')'.<br>
       * Generally the lcp value can be received with ' i==0 ? o1.length : Math.abs(i)-1', where 'i'
       * is the return value.
       */
      @Override
      public int compare(byte[] o1, byte[] o2) {
         for (int i = 0; i < o1.length && i < o2.length; i++) {
            if (o1[i] < o2[i]) {
               return -(i + 1);
            } else if (o1[i] > o2[i]) {
               return (i + 1);
            }
         }

         if (o1.length < o2.length) {
            return -(o1.length + 1);
         } else if (o1.length > o2.length) {
            return (o2.length + 1);
         } else {
            return 0;
         }
      }

   }
}
 